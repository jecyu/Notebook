# 10 åˆ†é’Ÿç†è§£ JS åŸå‹æ¦‚å¿µä¸åº”ç”¨

<!-- JS åŸå‹â€”â€”å®è·µæ€»ç»“å‹ -->

## å‰è¨€

å¦‚æœæœ‰äººå‘ä½ è¯·æ•™ã€ŒåŸå‹ã€è¿™ä¸¤ä¸ªå­—æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä½ ä¼šæ€ä¹ˆè§£é‡Šå‘¢ï¼Ÿä¸åŒé¢†åŸŸçš„äººå¯èƒ½æœ‰ä¸åŒçš„è§è§£ã€‚åœ¨æ–‡å­¦ç”µå½±ä½œå“é¢†åŸŸï¼Œä¸»çº¿å‰§æƒ…ä¾¿æ˜¯ä¸€ä¸ªåŸå‹ï¼Œä¾‹å¦‚ç½—å¯†æ¬§ä¸èŒ±ä¸½å¶çš„åŸå‹æ˜¯é­é‡å®¶äººåå¯¹ä¸ºçˆ±æ®‰æƒ…çš„ç”·å¥³ä¸»è§’ï¼Œè·Ÿä¸­å›½æ•…äº‹çš„æ¢å±±ä¼¯ä¸ç¥è‹±å°å¾ˆåƒã€‚å¦å¤–ï¼Œæ•…äº‹ä¸­çš„äººç‰©ä¹Ÿå¯ä»¥æ˜¯åŸå‹ï¼Œä¾‹å¦‚è‹±é›„çš„åŸå‹ã€‚åœ¨äº’è”ç½‘é¢†åŸŸæ›´æ˜¯ç»†åˆ†ä¸å°‘ï¼Œåœ¨æ¸¸æˆå¼€å‘ä¸­ï¼Œä¸€ä¸ªåŸå‹æ˜¯å¯ä»¥å¿«é€Ÿè¯•ç©çš„ demoã€‚å¯¹äºç½‘ç«™å¼€å‘ï¼ŒåŸå‹å¯ä»¥èµ·å§‹äºäº§å“ç»ç†æ‰‹ä¸­çš„çº¿æ¡†å›¾ã€‚

é‚£ä¹ˆåŸå‹æ˜¯ä»€ä¹ˆå‘¢ï¼Œæ¥ä¸‹æ¥æœ¬æ–‡ä¼šä»ä¸€èˆ¬çš„åŸå‹è¯´åˆ° JS çš„åŸå‹ä»¥åŠ JS ä¸ºä»€ä¹ˆéœ€è¦åŸå‹ã€‚

æœ¬æ–‡ä¸»è¦è®²è§£äº†ä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€æ˜¯å¦‚ä½•æ–°å»ºå¯¹è±¡ä»¥åŠç»§æ‰¿ç±»çš„ï¼Œè€Œä½¿ç”¨ç±»æ˜¯ä¸ºäº†å…±äº«ä¸€äº›å…¬å…±çš„æ–¹æ³•å’Œå±æ€§ã€‚JS åˆæ˜¯å¦‚ä½•é€šè¿‡åŸå‹è¿™ä¸ªæ¦‚å¿µæ¥å®ç°è¿™ä¸¤ä¸ªæ¦‚å¿µçš„ï¼ŒåŸåˆ™ä¸Šæ˜¯åŸºäºç±»ç»§æ‰¿ä¸åŸºäºåŸå‹ç»§æ‰¿çš„ä¸¤ç§åŒºåˆ«ã€‚

**æ–‡ç« å¤§çº²**

- ä»€ä¹ˆæ˜¯åŸå‹
- è®¡ç®—æœºä¸­çš„åŸå‹
- ç»†è¯´ JS ä¸­çš„åŸå‹
- JS åŸå‹åº”ç”¨åœºæ™¯

**é¢å‘è¯»è€…**ï¼šå¯¹äº JS åŸå‹é“¾æ¦‚å¿µæ¨¡ç³Šçš„å‰ç«¯å·¥ç¨‹å¸ˆï¼Œè¯´ä¸æ¸…`__proto__` ä¸ `prototype` çš„åŒºåˆ«ã€‚

## ä»€ä¹ˆæ˜¯åŸå‹ï¼Ÿ

ä¸¾ä¸ªä¾‹å­ï¼Œä½ è¿˜è®°å¾— 2016 å¹´å¤§ç«çš„åŠ¨ç”»ç”µå½±æ˜¯ä»€ä¹ˆï¼Ÿé‚£å°±æ˜¯æ–°æµ·è¯šçš„ä½œå“[ã€Šä½ çš„åå­—ã€‹](https://zh.wikipedia.org/wiki/%E4%BD%A0%E7%9A%84%E5%90%8D%E5%AD%97%E3%80%82#%E6%BA%90%E8%B5%B7)ï¼Œä¸”ä¸è¯´å¥ä¹åŠ¨å¬ï¼Œåœ¨å‰§æƒ…ä¸Šä¹Ÿè®©äººå°è±¡æ·±åˆ»ã€‚å‰§æƒ…å¹¶éä»¥å•çº¯æ‹çˆ±é¢˜æä¸ºä¸»ï¼Œè€Œæ˜¯â€œæœ‰ç€è§é¢çš„å‘½è¿å´è¿Ÿè¿Ÿæ— æ³•ç›¸è§çš„ä¸¤äººâ€ã€‚è€Œè¿™éƒ¨ä½œç”¨çš„åŸå‹ï¼Œä¾¿æ˜¯ä»¥æ—©æœŸçš„æ–°æµ·åŸ[ã€Šåå­—è·¯å£ã€‹](<https://zh.wikipedia.org/wiki/%E5%8D%81%E5%AD%97%E8%B7%AF%E5%8F%A3_(%E5%8B%95%E7%95%AB)>)ä¸ºåŸå‹ã€‚

![](../.vuepress/public/images/2020-06-08-07-53-09-js-prototype-01.png)

åœ¨æ–‡å­¦ã€ç”µå½±ã€æ¸¸æˆåˆ›ä½œç­‰é¢†åŸŸï¼Œé™¤äº†æ•…äº‹æƒ…èŠ‚å¤–ï¼Œäººç‰©ä¸»è§’ä¹Ÿæ˜¯ç”±åŸå‹ä¸€æ­¥æ­¥æ”¹è‰¯è€Œæ¥ã€‚æ¯”å¦‚[è™æ€åŸå‹](https://zh.wikipedia.org/wiki/%E8%99%90%E6%9D%80%E5%8E%9F%E5%BD%A2) æ¸¸æˆä¸­çš„ä¸»è§’çº¸é¢åŸå‹å¦‚ä¸‹ï¼Œé™¤äº†è®¾å®šå¥½äººç‰©çš„å¤–è¡¨å¤–ï¼Œæ›´é‡è¦çš„æ˜¯è¦è®¾å®šä»–çš„è¡Œä¸ºï¼ˆåŠŸèƒ½ï¼‰ï¼š

![](2020-08-27-14-19-00-prototype-game.png)

æ— è®ºæ˜¯æ•…äº‹å‰§æƒ…ã€äººç‰©ï¼Œè¿˜æ˜¯åˆ¶é€ ä¸€ä¸ªå·¥ä¸šäº§å“ï¼Œ<u>æ‰€è°“åŸå‹å°±æ˜¯æœ€åˆçš„æ ·ä¾‹ã€æ¨¡å‹</u>ï¼ˆå¾ˆå¤šæ—¶å€™æ¨¡å‹å’ŒåŸå‹è§†ä¸ºåŒä¸€ä¸ªä¸œè¥¿ï¼‰æˆ–è€…æ˜¯ä¸ºäº†æµ‹è¯•æ¦‚å¿µè€Œæ„å»ºçš„äº§å“ã€‚

### åŸå‹çš„ç‰¹ç‚¹ä¸ç›®çš„

åŸå‹æœ€æœ¬è´¨çš„ç‰¹ç‚¹æ˜¯ï¼Œ<u>å®ƒæ˜¯ä½ æœ€ç»ˆåˆ¶ä½œçš„æˆå“çš„æœ€å°è§„æ¨¡ï¼Œä½†å…·æœ‰æ ¸å¿ƒåŠŸèƒ½çš„ä¸œè¥¿ã€‚</u>å®ƒçš„ç›®çš„æ˜¯ä¸ºäº†è®©æˆ‘ä»¬å¯ä»¥å¿«é€Ÿå¤šæ¬¡æµ‹è¯•è‡ªå·±çš„æƒ³æ³•æ˜¯å¦æ­£ç¡®ï¼Œæ¯”å¦‚ä¸€ä¸ªæ¸¸æˆè®¾è®¡å¸ˆï¼Œä»–éœ€è¦ä¸æ–­åˆ¶ä½œå…·å¤‡æ ¸å¿ƒåŠŸèƒ½çš„æ¸¸æˆåŸå‹ï¼Œæµ‹è¯•æ¸¸æˆåŸå‹ï¼Œä»¥æ¥æµ‹è¯•æ¸¸æˆçš„æœºåˆ¶ã€è§„åˆ™ç­‰æ˜¯å¦åˆç†ã€‚å½“ç„¶åœ¨åˆ¶ä½œåˆ¶ä½œåŸå‹ï¼Œä»–ä¹Ÿå¯ä»¥å‚è€ƒæˆåŠŸçš„æ¸¸æˆçš„åŸå‹ã€‚

æœ€æ—©è§†è§‰ä¸Šå¯ä»¥äº¤äº’çš„åŸå‹ï¼Œä¾¿æ˜¯çº¸é¢åŸå‹ï¼ˆä¹Ÿå°±æ˜¯åœ¨çº¸ä¸Šç”»ç”»ï¼Œä»¥åŠä½¿ç”¨ä¸€äº›ç©å…·ç±»çš„ä¸œè¥¿æ„å»ºï¼‰ã€‚

åŸå‹çš„è§„æ¨¡å¤§å°æ˜¯ç›¸å¯¹æˆå“è€Œè¨€çš„ï¼Œè€Œåœ¨æ¯ä¸ªé˜¶æ®µéƒ½å¯ä»¥æˆä¸ºä¸‹ä¸€ä¸ªé˜¶æ®µçš„åŸå‹ï¼Œä¹Ÿå°±æ˜¯è¯´åŸå‹ä¹‹é—´å¯ä»¥è¿›è¡Œ`ç»§æ‰¿`ï¼Œä»çº¸é¢åŸå‹åˆ°çœŸæ­£å¯ä»¥è¿›è¡Œäº¤äº’çš„åŸå‹ã€‚

[ä¸€ä¸ªæœºå™¨äººï¼Œä»çº¸é¢åˆ°çœŸæ­£å¯ä»¥åŠ¨çš„æ¨¡å‹ gif](../.vuepress/public/images/prototype-stages-lg-1.gif)

### åŸå‹ç»å†çš„é˜¶æ®µ

![](../.vuepress/public/images/2020-06-09-07-22-37-js-prototype-01.png)

ä»åŸå‹åˆ°æˆå“ï¼Œä¹Ÿä¸æ˜¯ä¸€æ¬¡åˆ°ä½ï¼Œå…¶ä¸­ä¹Ÿç»å†äº†å¾ˆå¤šçš„ç‰ˆæœ¬è¿­ä»£ï¼Œè·Ÿæˆ‘ä»¬ç¼–ç¨‹ä¸€æ ·çš„é“ç†ï¼Œè‚¯å®šä¸æ˜¯ä¸€æ¬¡åˆ°ä½ã€‚ä¸Šå›¾ä¸­å°±æ˜¾ç¤ºäº†ä»å»ºç«‹åŸå‹-å®šä¹‰åŸå‹-å¼€å‘åŸå‹-è¯„ä¼°åŸå‹çš„é˜¶æ®µã€‚

## è®¡ç®—æœºç¼–ç¨‹ä¸­çš„åŸå‹

<!-- ### ä½¿ç”¨è®¡ç®—æœºè¯­è¨€æè¿°ç¨‹åº

TODO è¿™å—æçº²ä½¿ç”¨è®¡ç®—æœºè¯­è¨€æè¿°ç¨‹åºè€ƒè™‘æ˜¯å¦è¿˜éœ€è¦ï¼Œåç»­è€ƒè™‘æ˜¯å¦ä¿ç•™ã€‚

è¿™é‡Œç®€å•æè¿°ä¸‹å¦‚ä½•è®©è®¡ç®—æœºå®ç°æˆ‘ä»¬çš„å‘½ä»¤ï¼Œä»¥ä¾¿æ›´åŠ å¥½ç†è§£`é¢å‘è¿‡ç¨‹`ç¼–ç¨‹çš„ç”±æ¥ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬è¦ç¼–å†™ä¸€ä¸ªæè¿°äººç‰©çš„ç¨‹åºï¼Œä»–å…·æœ‰ä»ç«™ç«‹è½¬ä¸ºè¡Œèµ°çš„åŠŸèƒ½ã€‚

å¯¹äºè®¡ç®—æœºæ¥è¯´è¿™æ ·å¤æ‚çš„å‘½ä»¤éœ€è¦æ‹†åˆ†ä¸ºä¸€ç³»åˆ—ç®€å•å‘½ä»¤ï¼Œå¦‚ä½•ç”¨ç®€å•å‘½ä»¤æŒ‡æŒ¥å¦å¤–ä¸€ä¸ªäººä»ç«™ç«‹çŠ¶æ€è½¬ä¸ºè¡Œèµ°çŠ¶æ€å‘¢ï¼Ÿ

![](../.vuepress/public/images/2020-06-15-08-55-31-walk.png)

é¦–å…ˆï¼Œè®©åŒä¼´ç«™ç«‹åœ¨åœ°æ¿ä¸Šï¼Œç„¶åå‘Šè¯‰ä»–ä¸¥æ ¼æŒ‰ä½ æ‰€å‘å‡ºçš„å‘½ä»¤çš„å­—é¢å«ä¹‰åšç›¸åº”çš„åŠ¨ä½œã€‚ä½ çš„ç›®æ ‡æ˜¯å‘åŒä¼´å‘å‡ºä¸€ç³»åˆ—å‘½ä»¤ï¼Œä½¿ä»–èµ°èµ·æ¥ã€‚ä½†ä½ ä¸èƒ½ä½¿ç”¨â€œèµ°èµ·æ¥â€ä¹‹ç±»çš„å¤æ‚å‘½ä»¤ï¼Œåªèƒ½å‘æŒ‡æŒ¥æœºå™¨äººä¸€æ ·ä½¿ç”¨ç®€å•å‘½ä»¤ï¼Œä¾‹å¦‚ã€‚

1. ä»¥å·¦è„šä¸ºæ”¯æ’‘ï¼Œæèµ·ä½ çš„å³è„šï¼Œä»¥èº¯å¹²ä¸ºè½´å¿ƒï¼Œå‘å‰è·¨ 30 åº¦
2. å‘å‰ç”©åŠ¨ä½ çš„å·¦è‡‚ï¼Œå³è‡‚åŒæ—¶æœåæ‘†åŠ¨ã€‚
3. ä»¥å³è„šä¸ºæ”¯æ’‘ï¼Œæèµ·ä½ çš„å·¦è„šï¼Œä»¥èº¯å¹²ä¸ºè½´å¿ƒï¼Œå‘å‰è·¨ 30 åº¦
4. å‘å‰ç”©åŠ¨ä½ çš„å³è‡‚ï¼Œå·¦è‡‚åŒæ—¶æœåæ‘†åŠ¨ã€‚
5. é‡æ–°å›åˆ°ç¬¬ 1 æ­¥éª¤ã€‚

```js
// å®ç°ä¸€ä¸ª walk ç¨‹åºï¼Œè¿™é‡Œæ˜¯ä¼ªä»£ç è¯­è¨€ã€‚ç„¶åäº¤ç»™è®¡ç®—æœºè¿è¡Œ walk ç¨‹åºè¿›è¡Œè®¡ç®—å¤„ç†ã€‚
main()
  Walk() {
    LiftRightFoot()
    SwingLeftAndRightArm()
    LiftLeftFoot()
    SwingLeftAndRightArm()
  }
```

å¯ä»¥çœ‹åˆ°å¯¹äºäººç±»æ¥è¯´ä¸€ä¸ªç®€å•çš„ç«™ç«‹åŠ¨ä½œåœ¨è®¡ç®—æœºä¸Šéœ€è¦æ‹†åˆ†æˆå¤šä¸ªæ­¥éª¤çš„ï¼Œå®Œå…¨æ˜¯é¢å‘è¿‡ç¨‹çš„å®ç°ã€‚ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ›´ä½çº§çš„è¯­è¨€å¦‚ C è¯­è¨€æ˜¯ä½¿ç”¨é¢å‘è¿‡ç¨‹çš„å†™æ³•äº†ã€‚-->

<!-- ### è®¡ç®—æœºä¸­çš„åŸå‹ -->

åœ¨è®¡ç®—æœºç¼–ç¨‹ä¸­æ˜¯é€šè¿‡`é¢å‘å¯¹è±¡ç¼–ç¨‹`æ¦‚å¿µå®ç°åŸå‹çš„ã€‚è¦æƒ³äº†è§£ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿè®©æˆ‘ä»¬å…ˆå›é¡¾`é¢å‘è¿‡ç¨‹`ç¼–ç¨‹ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬éœ€è¦åœ¨å±å¹•ä¸Šç”»å‡ºå››æ–¹å½¢ã€åœ†å½¢ä¸ä¸‰è§’å½¢ï¼Œåœ¨ç”¨æˆ·ç‚¹é€‰å›¾å½¢æ—¶ï¼Œå›¾å½¢éœ€è¦æŒ‰é¡ºæ—¶é’Ÿæ–¹å‘é€‰è½¬ 360 åº¦å¹¶ä¾æ®å½¢çŠ¶çš„ä¸åŒæ’­æ”¾ä¸åŒçš„ AIF éŸ³æ•ˆæ–‡ä»¶ã€‚

<!-- ![](./sketch/æ—‹è½¬çš„å››è¾¹å½¢.drawio.svg) -->

å¯¹äºè®¡ç®—æœºæ¥è¯´ï¼Œå®ƒæ˜¯ä¸èƒ½è¯†åˆ«ä¸Šé¢è¿™ä¹ˆå¤æ‚çš„å‘½ä»¤çš„ã€‚è¿™äº›å‘½ä»¤éœ€è¦æ‹†åˆ†ä¸ºä¸€ç³»åˆ—ç®€å•å‘½ä»¤ï¼Œåˆ†æ­¥æ­¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯é¢å‘è¿‡ç¨‹çš„æ€ç»´ï¼Œè¿™ä¸ªç¨‹åºè¦æ‰§è¡Œä»€ä¹ˆåŠ¨ä½œï¼ŒåŸºäºæ­¤æˆ‘ä»¬ä¼šå†™å‡ºä»¥ä¸‹çš„ä»£ç ï¼š

```js
// ä¸¥æ ¼æ¥è¯´ï¼Œä¸‹é¢çš„ä»£ç å¯¹äºè®¡ç®—æœºæ¥è¯´ï¼Œä¹Ÿå¾ˆå¤æ‚ï¼Œä¸è¿‡è¶³å¤Ÿè®©æˆ‘ä»¬ç†è§£é¢å‘è¿‡ç¨‹çš„æ€ç»´äº†ã€‚

// ä½¿ç”¨å½¢çŠ¶ç¼–å·æ¥æ‰¾å¯»ç‰¹å®šç¼–å·çš„å›¾å½¢
rotate(shapeNum) {
 // æ—‹è½¬ 360Â°
}

playSound(shapeNum) {
  // æŸ¥è¯¢æ’­æ”¾å“ªä¸ª AIF éŸ³é¢‘æ–‡ä»¶
  // æ’­æ”¾
}
```

OKï¼Œçœ‹èµ·æ¥ç¨‹åºèƒ½å¤Ÿæ»¡è¶³éœ€æ±‚ã€‚è¿™ä¸ªæ—¶å€™ï¼Œè¦æ–°å¢ä¸€ä¸ªé˜¿å°”ç±³å·´åŸè™«ï¼ˆAmoebaï¼‰å½¢çŠ¶å¹¶æ’­æ”¾ .hifï¼ˆé«˜ä¿çœŸ(HiFi) éŸ³é¢‘ï¼‰å£°éŸ³æ–‡ä»¶ã€‚åŸæ¥çš„ rotate ç¨‹åºè¿˜å¯ä»¥ç”¨ï¼Œä½†æ˜¯ playSound éœ€è¦ä¿®æ”¹ã€‚

```js
playSound(shapeNum) {
  if ä¸æ˜¯ Amoeba
     // æŸ¥è¯¢ä½¿ç”¨å“ªä¸ª AIF æ–‡ä»¶
     // æ’­æ”¾
  else
    // æ’­æ”¾ amoeba.hif
}
```

è¿™ä¸ªæ—¶å€™å·²ç»å¯¹åŸæ¥æµ‹è¯•è¿‡çš„ç¨‹åºä»£ç è¿›è¡Œäº†ä¸€éƒ¨åˆ†çš„ä¿®æ”¹ã€‚å‡è®¾æˆ‘ä»¬ä¸€å¼€å§‹å¯¹å½¢çŠ¶çš„æ—‹è½¬é€»è¾‘æ˜¯è¿™æ ·å†™çš„ï¼š

1. æ‰¾å‡ºæŒ‡å®šå½¢çŠ¶çš„å¤–æ¥å››è¾¹å½¢ã€‚
2. è®¡ç®—å‡ºå››è¾¹å½¢çš„ä¸­å¿ƒç‚¹ï¼Œä»¥æ­¤ç‚¹ä¸ºè½´åšæ—‹è½¬ã€‚

![å¤–æ¥å››è¾¹å½¢]()

è€Œåç»­æ‰è¢«å‘ŠçŸ¥é˜¿å°”å·´åŸè™«çš„æ—‹è½¬è½´å¿ƒä¸æ˜¯å›¾å½¢çš„ä¸­å¿ƒï¼Œè€Œæ˜¯ç»•ç€ä¸€ç«¯æ—‹è½¬ï¼Œç±»ä¼¼ç§’é’ˆé‚£æ ·ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬ä¹Ÿè¦ä¿®æ”¹æµ‹è¯•å¥½çš„ rotate ç¨‹åºäº†ï¼Œç»™å®ƒåŠ ä¸Šè½´å¿ƒç‚¹çš„å‚æ•°ã€‚

```js
rotate(shapNum, xPt, yPt) {
  if ä¸æ˜¯ Amoeba
     // è®¡ç®—ä¸­å¿ƒç‚¹
     // ç„¶åæ—‹è½¬
  else
    // ä»¥ xPt å’Œ yPt ä½œä¸ºæ—‹è½¬ä¸­å¿ƒ
    // ç„¶åæ—‹è½¬
}
```

å¦‚æœç°åœ¨ç¨‹åºè¿˜è¦æ”¯æŒæ–°çš„å½¢çŠ¶ï¼Œå¯èƒ½åˆè¦å¯¹ rotate å’Œ playSound æ“åˆ€äº†ã€‚å¯è§è¿™æ ·çš„ä»£ç å¾ˆè„†å¼±ï¼Œåªè¦åŠ å…¥æ–°çš„åŠŸèƒ½å¾ˆå¯èƒ½å½±å“ç°æœ‰æ­£å¸¸çš„ç¨‹åºä»£ç ã€‚

é¢å‘è¿‡ç¨‹æ€è€ƒçš„è§’åº¦æ˜¯è¿™ä¸ªç¨‹åºè¦æ‰§è¡Œä»€ä¹ˆåŠ¨ä½œï¼Œå¦‚æœä½¿ç”¨é¢å‘å¯¹è±¡çš„æ€ç»´æ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿ

é‚£é¢å‘å¯¹è±¡ï¼Œé¦–å…ˆå¾—æœ‰ä¸ªå¯¹è±¡ã€‚ç”Ÿæ´»ä¸­çš„å¯¹è±¡åº”è¯¥æ˜¯è¿™æ ·çš„

<!-- ![ç”·å¥³ç»“å¯¹ç¼–ç¨‹ğŸ‘€é¼“åŠ±å¸ˆ]() -->

ç¼–ç¨‹ä¸­ï¼Œå¾—é€šè¿‡ç±»è¿›è¡Œå®ä¾‹åŒ–ç”Ÿæˆã€‚æ‰€ä»¥è¦å®ç°é¢å‘å¯¹è±¡ï¼Œå…ˆè¦å®ç°ç±»çš„å®šä¹‰ï¼Œå› ä¸ºå¯¹è±¡æ˜¯é ç±»çš„æ¨¡å‹å¡‘é€ å‡ºæ¥çš„ã€‚

```java
// å®šä¹‰
public class Person {
  private void walk() {}
}
// å®ä¾‹åŒ–
Person personA = new Person();
personA.walk()
Person personB = new Person();
personB.walk()
```

è¿™ä¸ªæ—¶å€™ personA å’Œ personB å…±äº« Person ç±»å¯¹è±¡ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œéƒ½å…·æœ‰è¡Œèµ°çš„åŠŸèƒ½ï¼Œå¤§å¤§æé«˜å¯ç»´æŠ¤æ€§å’Œå¤ç”¨æ€§ï¼Œè¿™ä¸ªæ—¶å€™æ€è€ƒçš„è§’åº¦ä¾¿æ˜¯è¿™ä¸ªç¨‹åºæœ‰ä»€ä¹ˆæ ·çš„äº‹ç‰©ä¸è§’åº¦ï¼ˆPersonï¼‰ï¼Ÿè¿™äº›äº‹ç‰©æœ‰ä»€ä¹ˆäº‹ä»¶ä¸åŠ¨ä½œï¼ˆwalkï¼‰ï¼Ÿ

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨é¢å‘å¯¹è±¡çš„æ€ç»´é‡æ„å‰é¢çš„ä»£ç ï¼Œé¦–å…ˆåˆ†åˆ«ä¸º 3 ä¸ªå½¢çŠ¶å„å†™å‡ºä¸€ä¸ªç±»ï¼š

![](../.vuepress/public/images/2020-06-22-07-43-50-class-diagram-01.png)

æˆ‘ä»¬å‘ç°è¿™ä¸‰ä¸ªç±»éƒ½æœ‰å…±åŒçš„ç±»æ–¹æ³• rotate()ã€playSound()ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å†æŠ½è±¡å‡ºä¸€ä¸ªçˆ¶ç±»å‡ºæ¥ï¼š

![](../.vuepress/public/images/2020-06-22-08-02-01-class-inherit.png)

è€Œå¯¹äºæ–°å¢çš„é˜¿å°”ç±³å·´åŸè™«å½¢çŠ¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ–°å»ºä¸€ä¸ªç±»ï¼Œç»§æ‰¿äº Shape çˆ¶ç±»ï¼Œä½†æ˜¯åªéœ€è¦è¦†å†™çˆ¶ç±»çš„ rotate() å’Œ playSound æ–¹æ³•å³å¯ï¼Œæ— éœ€æ”¹åŠ¨å¦å¤–ä¸‰ä¸ªç±»ã€‚

![](../.vuepress/public/images/2020-06-22-08-09-03-class-inherit-02.png)

æ€»ç»“ä¸‹ï¼Œé¢å‘å¯¹è±¡çš„åŸºæœ¬å®šä¹‰ã€‚

- ç±»ï¼ˆå‰é¢ä¾‹å­çš„ Person ç±»ï¼‰
- ç±»æ–¹æ³•ï¼ˆwalk æ–¹æ³•ï¼‰ä¸å±æ€§
- ç±»å®ä¾‹ï¼ˆpersonA å’Œ personBï¼‰

åŸºæœ¬æ¦‚å¿µï¼š

- å°è£…ï¼ˆå¯¹äºè®¿é—®è€…æ¥è¯´ï¼Œè®¿é—®çš„æƒé™å¦‚ä½•ï¼‰
- ç»§æ‰¿ï¼ˆç±»ã€æ¥å£ä¹‹é—´çš„ç»§æ‰¿ï¼ŒæŠŠå…±åŒçš„ç¨‹åºä»£ç æ”¾åœ¨çˆ¶ç±»ä¸­ï¼‰
- å¤šæ€ï¼ˆåŒä¸€ä¸ªæ–¹æ³•ï¼Œä¸åŒçš„å¯¹è±¡è¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºï¼Œä¾‹å¦‚ rotateï¼‰
- æŠ½è±¡ï¼ˆæŠŠå­ç±»çš„å…±åŒå±æ€§å’Œè¡Œä¸ºæŠ½è±¡åˆ°çˆ¶ç±»ä¸­ï¼‰

æ¥ä¸‹æ¥æˆ‘ä»¬è¦å¦å¤–è®¾è®¡ä¸€ä¸ªç¨‹åºï¼Œå¯ä»¥è®©ç”¨æˆ·è®¾å®šå°†ä¸€ç¾¤åŠ¨ç‰©ä¸¢åˆ°æŸç§ç¯å¢ƒä¸­ä»¥è§‚å¯Ÿä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ï¼Œæˆ‘ä»¬ç°åœ¨åªå…³æ³¨è®¾è®¡ï¼Œä»¥ä¾¿åŠ æ·±é¢å‘å¯¹è±¡çš„ç†è§£ã€‚

å‡è®¾ç°åœ¨ç¨‹åºåªæœ‰ä¸€éƒ¨åˆ†çš„åŠ¨ç‰©ï¼Œåç»­ä¼šåŠ å…¥å…¶ä»–çš„åŠ¨ç‰©ã€‚æ¯ä¸ªåŠ¨ç‰©éƒ½ç”¨ä¸€ä¸ªå¯¹è±¡æ¥è¡¨ç¤ºï¼Œä¸”åŠ¨ç‰©ä¼šåœ¨ç¯å¢ƒä¸­æ´»åŠ¨ï¼Œæ‰§è¡Œä»»ä½•è¢«è®¾è®¡å‡ºçš„è¡Œä¸ºï¼Œåˆ†ææ­¥éª¤å¦‚ä¸‹ï¼š

1. åˆ†ææ‰¾å‡ºå…·æœ‰å…±åŒå±æ€§å’Œè¡Œä¸ºçš„å¯¹è±¡ï¼ˆpictureã€foodã€hungerã€boundariesã€makeNodesã€eatã€roamï¼‰ã€‚
2. è®¾è®¡ä»£è¡¨å…±åŒçŠ¶æ€ä¸è¡Œä¸ºçš„ç±»ï¼ˆAnimalï¼‰ã€‚
3. å†³å®šå­ç±»æ˜¯å¦éœ€è¦è®©æŸé¡¹è¡Œä¸ºæœ‰ç‰¹å®šä¸åŒçš„è¿ä½œæ–¹å¼ã€‚ï¼ˆè¦†ç›– eatã€makeNoiseï¼‰
4. é€šè¿‡å¯»æ‰¾ä½¿ç”¨å…±åŒè¡Œä¸ºçš„å­ç±»æ‰¾å‡ºæ›´å¤šæŠ½è±¡åŒ–çš„æœºä¼šï¼ˆCanine çŠ¬ç§‘ã€Feline çŒ«ç§‘ï¼‰ã€‚

![](../.vuepress/public/images/2020-06-23-07-56-58-inhert-Animal.png)

æœ€ç»ˆå¾—å‡ºä¸€ä¸ªç®€å•çš„åˆ†ç±»ç»“æ„ã€‚

- Animalï¼ˆåŠ¨ç‰©ç±»ï¼‰
  - Canineï¼ˆçŠ¬ç§‘ï¼‰
    - Dogï¼ˆç‹—ï¼‰
    - Wolfï¼ˆç‹¼ï¼‰
  - Felineï¼ˆçŒ«ç§‘ï¼‰
    - Lionï¼ˆç‹®å­ï¼‰
    - Tigerï¼ˆè€è™ï¼‰
    - Catï¼ˆçŒ«ï¼‰

å®ç°é¢å‘å¯¹è±¡æ€æƒ³æœ‰ä¸¤ç§æ–¹æ³•ï¼ŒåŸºäºç±»å®ç°å’ŒåŸºäºåŸå‹å®ç°ï¼Œä¸‹é¢å°†ä½¿ç”¨ Java å’Œ JS æ¥å®ç°ã€‚

### ä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€

è¦ç†è§£é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œæœ€é‡è¦çš„ç‰¹ç‚¹å°±æ˜¯æ ¹æ®`ç±»å°è£…åˆ›å»ºå¯¹è±¡`ä¸`ç±»ä¹‹é—´ç»§æ‰¿`çš„æ¦‚å¿µäº†ã€‚åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å£°æ˜ä¸€ä¸ªç±»ä½œä¸ºåŸºç±»ï¼Œç„¶åé€šè¿‡ç»§æ‰¿è¿™ä¸ªåŸºç±»å®šä¹‰ä¸€ä¸ªæ–°ç±»ã€‚

æ ¹æ®ä¹‹å‰çš„æ ‘çŠ¶ç»“æ„ï¼Œæˆ‘ä»¬é¦–å…ˆå®šä¹‰ Animal ç±»ï¼š

```java
public class Animal {
	public String picture; // åŠ¨ç‰© JPEG å›¾åƒçš„åç§°
	public String food; // æ­¤åŠ¨ç‰©æ‰€åƒçš„é£Ÿç‰©
	public int hunger; // ä»£è¡¨é¥¥é¥¿ç¨‹åº¦ã€‚å®ƒä¼šæ ¹æ®åŠ¨ç‰©åƒäº†å¤šå°‘ä¸œè¥¿è€Œæ”¹å˜
	public Boundaries boundaries; // ä»£è¡¨åŠ¨ç‰©æ´»åŠ¨èŒƒå›´åŒºåŸŸçš„é•¿å®½

	public Animal(String picture, String food, int hunger, Boundaries boundaries) {
		this.picture = picture;
		this.food = food;
		this.hunger = hunger;
		this.boundaries = boundaries;
	}

	public void makeNoise() { // åŠ¨ç‰©å‘å‡ºå£°éŸ³çš„è¡Œä¸º
		System.out.println("Animal makeNoise!");
	}

	public void eat() { // åŠ¨ç‰©é‡åˆ°é£Ÿç‰©æ—¶çš„è¡Œä¸ºç¨‹åº
		System.out.println("Animal eat!");
	}

	public void sleep() { // ç¡çœ çš„è¡Œä¸ºç¨‹åº
		System.out.println("Animal sleep!");
	}

	public void roam() { // ä¸åœ¨è¿›é£Ÿæˆ–ç¡çœ æ—¶çš„è¡Œä¸ºç¨‹åº
		System.out.println("Animal roam!");
	}
}
```

ç„¶åï¼ŒåŸºäº Animal ç»§ç»­æ‰©å±•å‡ºä¸€ä¸ª Canine å’Œ Feline ç±»ï¼Œå®ƒä»¬éƒ½è¦†ç›–äº† Animal çš„ makeNoise å’Œ eat æ–¹æ³•ã€‚

```java
public class Canine extends Animal {

	public Canine(String picture, String food, int hunger, Boundaries boundaries) {
		super(picture, food, hunger, boundaries);
	}

	public void makeNoise() {
		System.out.println("Canine makeNoise!");
	}

	public void eat() {
		System.out.println("Canine eat!");
	}
}
```

```java
public class Feline extends Animal {

	public Feline(String picture, String food, int hunger, Boundaries boundaries) {
		super(picture, food, hunger, boundaries);
	}

	public void makeNoise() {
		System.out.println("Feline makeNoise!");
	}

	public void eat() {
		System.out.println("Feline makeNoise!");
	}
}

```

ç„¶åï¼Œå†æ„å»ºç»§æ‰¿äº Feline å’Œ Canine ç±»çš„ Dog ç±» å’Œ Cat ç±»ï¼š

```java
public class Cat extends Feline {
	public Cat(String picture, String food, int hunger, Boundaries boundaries) {
		super(picture, food, hunger, boundaries);
	}
}
```

```java
public class Dog extends Canine {

	public Dog(String picture, String food, int hunger, Boundaries boundaries) {
		super(picture, food, hunger, boundaries);
	}
}
```

æœ€åï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ® Dog ç±»å’Œ Cat ç±»è¿›è¡Œå®ä¾‹åŒ–å¹¶è¿›è¡Œè°ƒç”¨ï¼š

```java
public class Main {

	public static void main(String[] args) {
		Boundaries boundariesDog = new Boundaries();
		Boundaries boundariesCat = new Boundaries();
		Dog keji = new Dog("æŸ¯åŸº", "éª¨å¤´", 100, boundariesDog);
		Cat meiduan = new Cat("ç¾çŸ­", "é±¼", 100, boundariesCat);
		keji.makeNoise(); // Canine makeNoise!
		meiduan.makeNoise(); // Feline makeNoise!
	}
}
```

è®©æˆ‘ä»¬åˆ†æè¿™é‡Œçš„åŸå‹å…³ç³»ï¼Œ`Keji` çš„åŸå‹æ˜¯ `Dog`ï¼Œ`Dog` çš„åŸå‹æ˜¯ `Canine`ï¼Œè€Œ `Canine` çš„åŸå‹æ˜¯ `Animal`ã€‚ç±»ä¼¼çš„ï¼Œmeiduan ä¹Ÿæ˜¯å¦‚æ­¤ã€‚

é™¤äº†è¿™ç§ç›´è§‚çš„åŸå‹å¤–ï¼Œè¿˜æœ‰æ•°æ®åŸå‹ï¼ˆæ•°æ®çš„è¿ç§»ã€é›†æˆï¼‰ç­‰ï¼Œæœ‰å…´è¶£å¯ä»¥çœ‹

### åŸºäºåŸå‹ç»§æ‰¿çš„é¢å‘å¯¹è±¡ JS

åœ¨ä¼ ç»Ÿçš„åŸºäº Class è¯­è¨€å¦‚ Javaã€C++ã€C# ä¸­ï¼Œç»§æ‰¿çš„æœ¬è´¨æ˜¯ï¼ˆ`extend`ï¼‰æ‰©å±•ä¸€ä¸ªå·²æœ‰çš„ Classï¼Œå¹¶ç”Ÿæˆæ–°çš„ Subclassï¼Œç„¶åé€šè¿‡ç±»çš„æ„é€ å‡½æ•°è¿›è¡Œå®ä¾‹åŒ–ã€‚è¿™ç±»è¯­è¨€ä¸¥æ ¼åŒºåˆ†ç±»å’Œå®ä¾‹ï¼Œç»§æ‰¿å®é™…ä¸Šæ˜¯ç±»å‹çš„æ‰©å±•ã€‚ä½†æ˜¯ï¼ŒJavaScript æ— æ³•ç›´æ¥æ‰©å±•ä¸€ä¸ª Classã€‚

å¯¹äºå¦‚ä½•å®šä¹‰ç±»å’Œç»§æ‰¿ï¼ŒJS æœ‰è‡ªå·±çš„æƒ³æ³•ã€‚å®ƒä½¿ç”¨`æ„é€ å‡½æ•°ï¼ˆconstructorï¼‰`ä¸`åŸå‹ï¼ˆprototypeï¼‰`é—´æ¥å®ç°é¢å‘å¯¹è±¡çš„æ€æƒ³ã€‚

#### å®šä¹‰ç±»

<!-- å› ä¸ºåœ¨ js è¯­è¨€ä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µï¼ˆä¸ºä»€ä¹ˆæ²¡æœ‰ï¼Ÿï¼‰ï¼Œå› æ­¤ä½¿ç”¨åŸå‹æ¥å®ç°æ–°å¯¹è±¡å®ä¾‹çš„åˆ›å»ºå’Œç»§æ‰¿ã€‚ -->

1. é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œé€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡ï¼Œä»»ä½•çš„ javaScript å‡½æ•°éƒ½å¯ä»¥æ˜¯æ„é€ å‡½æ•°
2. ç„¶åä½¿ç”¨ prototype å®šä¹‰å…¬å…±çš„å±æ€§å’Œæ–¹æ³•ä»¥æ­¤æ›¿ä»£æ²¡æœ‰ç±»çš„å®šä¹‰ã€‚

```js
function Animal(picture, food, hunger, boundaries) {
  this.picture = picture;
  this.food = food;
  this.hunger = hunger;
  this.boundaries = boundaries;
}

Animal.prototype.makeNoise = function() {
  console.log("Animal makeNoise!");
};

Animal.prototype.eat = function() {
  console.log("Animal eat!");
};

Animal.prototype.sleep = function() {
  console.log("Animal sleep!");
};

Animal.prototype.roam = function() {
  console.log("Animal roam!");
};

exports.Animal = Animal;
```

#### å­ç±»å’Œç»§æ‰¿

æˆ‘ä»¬é€šè¿‡è®¾ç½®å­ç±»çš„ protype çš„å€¼ä¸ºçˆ¶ç±»çš„å€¼ï¼Œå¹¶åœ¨å­ç±»çš„æ„é€ å‡½æ•°è°ƒç”¨è¶…ç±»çš„æ„é€ å‡½æ•°å®ç°ç»§æ‰¿ã€‚

```js
function inheri(subClass, superClass) {
  subClass.prototype = Object.create(superClass.prototype); // å®ç°ç»§æ‰¿
  subClass.__proto__ = superClass; // å­ç±»çš„åŸå‹æŒ‡å‘çˆ¶ç±»
  // è¿™é‡Œçš„ä¸¤è¡Œä»£ç ç»§æ‰¿æ¯”ç›´æ¥ subClass.prototype =  new superClassï¼Œçµæ´»ï¼Œä¸ç”¨å®ä¾‹åŒ–ä¼ é€’å‚æ•°
  // è¡¥å›ä¸¢å¤±çš„å±æ€§
  Object.defineProperty(subClass, "constructor", {
    enumerable: false,
    value: subClass,
    writable: true,
  });
}

function Canine(picture, food, hunger, boundaries) {
  return Animal.call(this, picture, food, hunger, boundaries);
}
inheri(Canine, Animal);
// Canine.prototype = new Animal(picture, food, hunger, boundaries);
// å¯¹æ–¹æ³•è¿›è¡Œè¦†ç›–
Canine.prototype.makeNoise = function() {
  console.log("Canine makeNoise!");
  return "Canine makeNoise!";
};

Canine.prototype.eat = function() {
  console.log("Canine eat!");
};

function Dog(picture, food, hunger, boundaries) {
  Canine.call(this, picture, food, hunger, boundaries);
}
inheri(Dog, Canine);
```

æœ€åå®ä¾‹åŒ– Dog

```js
const boundariesDog = new Boundaries(0, 0, 5, 5);
const keji = new Dog("æŸ¯åŸº", "éª¨å¤´", 100, boundariesDog);
keji.makeNoise();
```

æ³¨ï¼šè¿™é‡Œçš„ä»£ç éƒ½æ˜¯ç®€å•çš„ç»§æ‰¿ï¼Œå°‘äº†å¾ˆå¤šè¿è¡Œä¸Šçš„åˆ¤æ–­ï¼Œæ›´åŠ ä¸¥è°¨çš„å¤„ç†å¯ä»¥è¯•ä¸‹åœ¨ [Babel ä¸­ ç”¨ ES6 Class ç¼–å†™ï¼Œçœ‹çœ‹è¾“å‡ºçš„ ES5 ä»£ç ](https://babeljs.io/repl#?browsers=defaults%2C%20not%20ie%2011%2C%20not%20ie_mob%2011&build=&builtIns=false&spec=false&loose=false&code_lz=MYGwhgzhAECCB2BLAtmE0DeAoAkMA9vBAC4BOArsMfqQBQAOiV5pApgDTQBm--AJpwAW5eAHNWpTgCN8IvmFKJWEAJSZcOYoMQQAdI2ZtoAXmgHiLVgG4NWnbp78T3Xnxs5N2vcLETnP8VJ3T3sZOQUlGFMw-HlFZXcAXyxcVABrVgA5fB1WWjUMaAB6IuhACqVASydAReVAL8VAB41AZ_TAELdAGQjALjlcZNxWMGJ8zGLSysBxBMAGJUB9jIrAN9NWtsBoL0B4vU6U6FXoCBBWVnp-wpLoQEN3QAJ3WcXlrDXoUnwwZF3B6EBYOUAKdUBt-PHANCNjmfaznGSuqBIDAAMJgJDwVjQVgAD2IrFiMAQKDQ6lwBCIZEo1FI0FoZiYFjYnBc_BJAQkJJicUiBQ0EHI9AkDEJlk4jgE0Apkmg1IiyhUSRSOGg6SyOQgeTpHnOIp6fWlAKAA&debug=false&forceAllTransforms=false&shippedProposals=false&circleciRepo=&evaluate=false&fileSize=false&timeTravel=false&sourceType=module&lineWrap=true&presets=env%2Ces2015%2Ces2016%2Creact%2Cstage-2%2Ces2015-loose%2Cenv&prettier=false&targets=&version=7.10.4&externalPlugins=)ã€‚

### ä¸€å¼ å›¾å¯¹æ¯”

<!-- ä¸€å¼ å›¾å¯¹æ¯”çœ‹æ˜¯å¦éœ€è¦æ”¾åˆ°å…¶ä»–ä½ç½® -->

| Category                        | Class-basedï¼ˆJavaï¼‰                                                                                 | Prototyp-based ï¼ˆJavaScriptï¼‰                                                                                |
| ------------------------------- | --------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------ |
| Class vs Instance               | Class and instance are distinct entities                                                            | All objects can inherit from another object.                                                                 |
| Definition                      | Defines a class with a class definitionï¼›instantiate a class with constructor methods.              | Define and create a set of objects with constructor functions.                                               |
| Creation of new object          | Create a single object with the new operator.                                                       | Same.                                                                                                        |
| Construction of object hierachy | Construct an object hierarchy by usinig class definitions to define subclasses of existing classes. | Construct an object hierarchy by assigning an object as the prototype associated with a constructor function |

æ— è®ºæ˜¯åŸºäºç±»çš„ java è¿˜æ˜¯åŸºäºåŸå‹çš„ js ï¼Œéƒ½æ˜¯ä¸ºäº†å®ç°é¢å‘å¯¹è±¡çš„æ¦‚å¿µï¼Œå¯ä»¥ç»Ÿä¸€ç†è§£ä¸ºåŸºäºåŸå‹çš„å®ç°ã€‚åªä¸è¿‡ java é€šè¿‡ class å’Œç±»çš„æ„é€ å‡½æ•°å®šä¹‰åŸå‹ï¼Œè€Œ js é€šè¿‡ prototype å’Œæ„é€ å‡½æ•°æ¥å®šä¹‰åŸå‹ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯åŸºäºåŸå‹å¼€å‘ã€‚

## ç»†è¯´ JS ä¸­çš„åŸå‹

ä¸‹é¢å…·ä½“è¯´è¯´ JS ä¸­çš„åŸå‹ã€‚åœ¨ JavaScript ä¸­ï¼Œå¯ä»¥å°†ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ‰©å±•åˆ°å¦ä¸€ä¸ªå¯¹è±¡ä¸Šï¼Œè¿™ä¸ªæ˜¯é€šè¿‡åŸå‹çš„æ¦‚å¿µå®ç°ã€‚

æ¯ä¸ªå¯¹è±¡éƒ½æœ‰åŸå‹çš„å¼•ç”¨ï¼Œå½“æŸ¥æ‰¾å±æ€§æ—¶ï¼Œè‹¥å¯¹è±¡æœ¬èº«ä¸å…·æœ‰è¯¥å±æ€§ï¼Œåˆ™ä¼šæŸ¥æ‰¾åŸå‹ä¸Šæ˜¯å¦æœ‰è¯¥å±æ€§ã€‚ä¾‹å¦‚ï¼Œä½ æ­£åœ¨å’Œä¸€ç»„äººå…±åŒç©ä¸€ä¸ªæ¸¸æˆï¼Œæ¸¸æˆè§„åˆ™ä¸ºï¼šä¸»æŒäººæé—®ï¼Œå¦‚æœä½ çŸ¥é“ç­”æ¡ˆï¼Œåˆ™å¯ç›´æ¥å›ç­”ï¼›å¦‚æœä½ ä¸çŸ¥é“ç­”æ¡ˆï¼Œåˆ™å¯ä»¥è¯¢é—®ä½ çš„ä¸‹ä¸€ä¸ªäººã€‚

åœ¨ JS ä¸­ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œå½“ä½¿ç”¨ new è°ƒç”¨å‡½æ•°çš„æ—¶å€™ï¼Œå‡½æ•°ä¼šä½œä¸ºæ„é€ å‡½æ•°æ¥ä½¿ç”¨ï¼Œä»¥æ„é€ å‡½æ•°çš„ prototype ä½œä¸ºåŸå‹ï¼Œç„¶åè§¦å‘ä¸€ä¸ªæ–°å¯¹è±¡çš„åˆ†é…ï¼š

![](2020-08-06-14-15-46-prototype.png)

ninja2 æ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡çš„å¼•ç”¨ï¼Œå…·æœ‰ swingSword æ–¹æ³•ï¼Œå¹¶è°ƒç”¨ swingSword æ–¹æ³•ã€‚

![](2020-08-06-14-24-09-prototype.png)

ç”±æ­¤å¯è§ï¼š

- æ¯ä¸€ä¸ªå‡½æ•°éƒ½å…·æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ `prototype`ã€‚
- æ¯ä¸€ä¸ªå‡½æ•°çš„åŸå‹ï¼ˆprototypeï¼‰éƒ½å…·æœ‰ä¸€ä¸ª `constructor` å±æ€§ï¼Œè¯¥å±æ€§æŒ‡å‘å‡½æ•°æœ¬èº«ã€‚
- æ–°åˆ›å»ºçš„å¯¹è±¡ ninja2 çš„ `__proto__` å±æ€§æŒ‡å‘æ„é€ å™¨çš„åŸå‹å³ prototypeã€‚

å› æ­¤ï¼Œå¯ä»¥é€šè¿‡ ninja2 è°ƒç”¨æ–¹æ³• swingSwordï¼Œå°†æŸ¥æ‰¾è¯¥è®¿é—®å§”æ‰˜åˆ° Ninja çš„åŸå‹å¯¹è±¡ä¸Šã€‚

å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ constructor å±æ€§æ¥è¿›è¡Œç±»å‹çš„æ ¡éªŒã€‚

```js
const assert = require("assert");
function Ninja() {}
const ninja = new Ninja();

assert(typeof ninja === "object", true, "The type of instance is object."); // é€šè¿‡ typeof æ£€æµ‹ ninja çš„ç±»å‹ï¼Œä½†ä»ç»“æœä»…ä»…èƒ½å¤Ÿå¾—çŸ¥ ninja æ˜¯ä¸€ä¸ªå¯¹è±¡è€Œå·²

assert(ninja instanceof Ninja, true, "instanceof identifies the constructor."); // é€šè¿‡ instanceof æ£€æµ‹ ninja çš„ç±»å‹ï¼Œå…¶ç»“æœæä¾›æ›´å¤šä¿¡æ¯â€”â€” ninja æ˜¯ç”± Ninja æ„é€ è€Œæ¥çš„

assert(
  ninja.constructor === Ninja,
  true,
  "The ninja object was created by the Ninja function."
);
```

### JS æ˜¯å¦‚ä½•ä½¿ç”¨åŸå‹æ„æˆåŸå‹é“¾è¿›è¡Œç±»çš„ç»§æ‰¿

æˆ‘ä»¬å·²ç»çŸ¥é“ä»€ä¹ˆæ˜¯åŸå‹ï¼Œä¹ŸçŸ¥é“å®ƒæ˜¯å¦‚ä½•ä½¿ç”¨åŸå‹æŸ¥æ‰¾å¼•ç”¨å±æ€§ã€‚åœ¨ JavaScript ä¸­ï¼Œç»§æ‰¿ï¼ˆInheritanceï¼‰æ˜¯åœ¨ä¸€ç§æ–°å¯¹è±¡ä¸Šå¤ç”¨ç°æœ‰å¯¹è±¡çš„å±æ€§çš„å½¢å¼ï¼Œè¿™æœ‰åŠ©äºé¿å…é‡å¤ä»£ç å’Œé‡å¤æ•°æ®ã€‚

æˆ‘ä»¬å°è¯•åœ¨ä»¥ä¸‹ä»£ç ä¸­å®ç°ç»§æ‰¿ï¼š

```js
function Animal() {}
// é€šè¿‡æ„é€ å‡½æ•°åŠå…¶åŸå‹ï¼Œåˆ›å»ºä¸€ä¸ªå…·æœ‰ makeNoise æ–¹æ³•çš„ Animal ç±»å‹
Animal.prototype.makeNoise = function() {
  console.log("Animal makeNoise!");
};

function Canine() {} // å®šä¹‰ Canine æ„é€ å‡½æ•°
Canine.prototype = {
  // è¯•å›¾é™„ç€ Animal çš„åŸå‹æ–¹æ³• makeNoise åˆ° Canine çš„åŸå‹ä¸Š
  makeNoise: Animal.prototype.makeNoise,
};

const canine = new Canine();
assert.strictEqual(
  canine instanceof Canine,
  true,
  "canine receives functionality from the Canine prototype"
);

assert.strictEqual(
  canine instanceof Animal,
  false,
  "... and the Animal prototype."
);
assert.strictEqual(
  canine instanceof Object,
  true,
  "... and the Object prototype."
);
```

è™½ç„¶æˆ‘ä»¬æŠŠ Animal çš„ makeNoise å¤åˆ¶åˆ° Canine èº«ä¸Šï¼Œä½†æ˜¯æ— æ³•ä½¿å¾— Canine ç§°ä¸ºçœŸæ­£çš„ Animal ç±»å‹ã€‚è¿™ä¸æ˜¯çœŸæ­£çš„ç»§æ‰¿â€”â€”ä»…ä»…æ˜¯å¤åˆ¶ã€‚

è¦æƒ³å®ç°çœŸæ­£ç»§æ‰¿çš„è¯ï¼Œè¿˜éœ€è¦çŸ¥é“åŸå‹é“¾çš„å­˜åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åŸå‹æ„æˆåŸå‹é“¾è¿›è¡ŒçœŸæ­£æ„ä¹‰ä¸Šç±»çš„ç»§æ‰¿ã€‚åœ¨åŸå‹é“¾ä¸Šï¼Œkeji ç»§æ‰¿ Dogï¼ŒDog ç»§æ‰¿ Canineï¼Œ Canine ç»§æ‰¿ Animalï¼Œä»¥æ­¤ç±»æ¨ï¼Œä¸€ç›´åˆ° Objectã€‚

å…¶åŸºæœ¬æ€æƒ³æ˜¯åˆ©ç”¨åŸå‹è®©ä¸€ä¸ªå¼•ç”¨ç±»å‹ç»§æ‰¿å¦ä¸€ä¸ªç±»å‹çš„å±æ€§å’Œæ–¹æ³•ï¼Œç®€å•å›é¡¾ä¸€ä¸‹æ„é€ å‡½æ•°ã€åŸå‹å’Œå®ä¾‹çš„å…³ç³»ï¼šæ¯ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼ŒåŸå‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡ï¼ŒåŸå‹å¯¹è±¡éƒ½å«æœ‰ä¸€ä¸ªæŒ‡å‘æ„é€ å‡½æ•°çš„æŒ‡é’ˆï¼Œè€Œå®ä¾‹éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘åŸå‹å¯¹è±¡çš„å†…éƒ¨æŒ‡é’ˆã€‚

é‚£ä¹ˆï¼Œå‡å¦‚æˆ‘ä»¬è®©åŸå‹å¯¹è±¡ç­‰äºå¦ä¸€ä¸ªç±»å‹çš„å®ä¾‹ï¼Œç»“æœä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿæ˜¾ç„¶ï¼Œæ­¤æ—¶çš„åŸå‹å¯¹è±¡å°†åŒ…å«ä¸€ä¸ªæŒ‡å‘å¦ä¸€ä¸ªåŸå‹çš„æŒ‡é’ˆï¼Œç›¸åº”åœ°ï¼Œå¦ä¸€ä¸ªåŸå‹ä¸­ä¹ŸåŒ…å«ç€ä¸€ä¸ªæŒ‡å‘å¦ä¸€ä¸ªæ„é€ å‡½æ•°çš„æŒ‡é’ˆ

ï¼ˆè´´å›¾ï¼‰keji-dog-Canine-Animalã€‚

<!-- ã€ŠJavaScript é«˜çº§ç¨‹åºè®¾è®¡3ã€‹å…³äºåŸå‹é“¾çš„æ¦‚å¿µ -->

åˆ›å»ºè¿™æ ·çš„åŸå‹é“¾çš„ä¸€ç§æ–¹å¼æ˜¯ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ç›´æ¥æ˜¯å¦ä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹ï¼š

```js
const assert = require("assert");
function Animal() {}
Animal.prototype.makeNoise = function() {};

function Canine() {}
`Canine.prototype = new Animal();`; // é€šè¿‡å°† Canine çš„åŸå‹èµ‹å€¼ä¸º Animal çš„å®ä¾‹ï¼Œå®ç° Canine ç»§æ‰¿ Animalï¼ŒCanine æŒ‡å‘æ–°çš„åŸå‹ï¼Œç¼ºç‚¹æ˜¯ä¸¢å¤±äº†åŸæ¥çš„ prototype çš„ constructor å±æ€§

const animal1 = new Animal();
const canine = new Canine();
assert.strictEqual(
  canine instanceof Canine,
  true,
  "canine receives functionlity from the Canine prototype."
);
assert.strictEqual(
  canine instanceof Animal,
  true,
  "... and the Canine prototype."
);
assert.strictEqual(
  typeof canine.makeNoise === "function",
  true,
  "... and the Object prototype."
);
```

è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®ç°è®¿é—®å¯¹è±¡çš„å±æ€§ä¼šé€šè¿‡åŸå‹é“¾å±‚å±‚å‘ä¸Šå¯»æ‰¾äº†ï¼Œæ—¢å¯ä»¥è®¿é—® Animal çš„å®ä¾‹å±æ€§ï¼Œä¹Ÿå¯ä»¥è®¿é—®å®ƒåŸå‹ä¸Šçš„å±æ€§ã€‚

#### é‡å†™ contructor çš„é—®é¢˜

åœ¨å‰é¢æˆ‘ä»¬å®ç°ç»§æ‰¿çš„è¿‡ç¨‹ä¸­ï¼Œç›´æ¥æŠŠ Animal çš„å®ä¾‹å¯¹è±¡ä½œä¸º Canine çš„åŸå‹æ—¶ï¼Œæˆ‘ä»¬å·²ç»ä¸¢å¤±äº† Canine ä¸ Canine åˆå§‹åŸå‹ä¹‹é—´çš„å…³è”ã€‚è¿™æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸º constructor å¯ä»¥ç”¨æ¥ç›‘æµ‹ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ç”±æŸä¸€ä¸ªå‡½æ•°åˆ›å»ºçš„ã€‚

```js
assert(
  canine.constructor === Canine,
  "The canine object was created by the Canine constructor."
);
```

ä½†æ˜¯å‰é¢çš„ç¨‹åºæ˜¯å¦æ— æ³•é€šè¿‡è¿™ä¸ªæµ‹è¯•ã€‚

![](2020-08-11-14-31-17-prototype.png)

å¦‚å›¾æ‰€ç¤ºï¼Œæ— æ³•æŸ¥æ‰¾åˆ° Canine å¯¹è±¡çš„ constructor å±æ€§ã€‚å›è°ƒåŸå‹ä¸Šï¼ŒåŸå‹ä¸Šä¹Ÿæ²¡æœ‰ constructor å±æ€§ï¼ˆå› ä¸º **proto** æŒ‡å‘ Animal å®ä¾‹å¯¹è±¡äº†ï¼‰ï¼Œç»§ç»­åœ¨åŸå‹é“¾ä¸Šè¿½æº¯ï¼Œåœ¨ Animal å¯¹è±¡çš„åŸå‹è¿˜æ˜¯é‚£ä¸ªå…·æœ‰æŒ‡å‘ Animal æœ¬èº«çš„ constructor å±æ€§ã€‚äº‹å®ä¸Šï¼Œå¦‚æœæˆ‘ä»¬è¯¢é—® Canine å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç­”æ¡ˆæ˜¯ Animalï¼Œä½†æ˜¯è¿™ä¸ªç­”æ¡ˆæ˜¯é”™è¯¯çš„ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ä¿®å¤è¿™ä¸ªç¼ºé™·ï¼š

```js
// ....
Canine.prototype = new Animal();
// åœ¨è¿™é‡Œæ·»åŠ 
Object.defineProperty(Canine.prototype, "constructor", {
  // å®šä¹‰ä¸€ä¸ªæ–°çš„ä¸å¯æšä¸¾çš„ constructor å±æ€§ï¼Œå±æ€§å€¼ä¸º Ninja
  enumerable: false,
  value: Canine,
  writable: true,
});
//...
```

![](2020-08-11-15-11-54-prototype.png)

ä¿®å¤åï¼Œå¯ä»¥çœ‹åˆ° canine å¯¹è±¡å’Œ Canine éƒ½æœ‰ constructor å±æ€§äº†ã€‚

#### è¿›ä¸€æ­¥ä¼˜åŒ–ç»§æ‰¿æ–¹å¼

åœ¨å‰é¢çš„å®ç°æ–¹å¼ä¸­ï¼š`Canine.prototype = new Animal();`è¿˜æ²¡æœ‰è§£å†³çš„é—®é¢˜å°±æ˜¯ï¼šå¦‚æœè¦ä½¿ç”¨ Animal æ„é€ å‡½æ•°åˆå§‹åŒ–ä¸€äº›çŠ¶æ€ï¼Œæ¯”å¦‚ foodï¼Œpictureï¼Œåªèƒ½æŠŠ Animal æ„é€ å‡½æ•°ç›´æ¥ä¼ é€’ï¼Œç„¶åè®°å½•å±æ€§åˆ° Canine çš„å®ä¾‹å¯¹è±¡ä¸Šã€‚

æˆ‘ä»¬å¯ä»¥æŠŠ `Canine.prototype = new Animal();` æ‹†æˆä¸¤ä¸ªæ­¥éª¤ï¼š

1. inheri å‡½æ•°å¤„ç† Canine åˆ° Animal çš„é“¾æ¥è®¿é—®ã€‚

```js
subClass.prototype = Object.create(superClass.prototype); // å®ç°ç»§æ‰¿
// subClass.__proto__ = superClass;  // è¿™é‡Œä»…ä»…æ˜¯è¡¨é¢å­ç±»æ„é€ å‡½æ•°ä½œä¸ºçš„å¯¹è±¡ï¼Œä¹Ÿæœ‰æŒ‡é’ˆæŒ‡å‘è¶…ç±»
```

é€šè¿‡å®ä¾‹åŒ–çˆ¶ç±»çš„åŸå‹å®ç°ç»§æ‰¿ï¼Œè¿™é‡Œä½¿ç”¨ Object.create æ˜¯ä¸è¿è¡Œæ„é€ å‡½æ•°çš„ä»£ç ï¼Œå› ä¸ºè¿™ä¸ªå·²ç»åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨äº†ã€‚

ä½¿ç”¨ Object.create

2. åœ¨ Canine æ„é€ å‡½æ•°ä¸­è°ƒç”¨ Animal çš„æ„é€ å‡½æ•°ï¼Œå¹¶æŠŠå±æ€§è®°å½•åˆ° Canine çš„å®ä¾‹å¯¹è±¡ä¸Šã€‚

```js
function inheri(subClass, superClass) {
  `subClass.prototype = Object.create(superClass.prototype);`; // å®ç°ç»§æ‰¿
  // subClass.__proto__ = superClass;  // å­ç±»çš„åŸå‹æŒ‡å‘çˆ¶ç±»ï¼Œä¸éœ€è¦ç”¨
  // è¿™é‡Œçš„ä¸¤è¡Œä»£ç ç»§æ‰¿æ¯”ç›´æ¥ subClass.prototype =  new superClassï¼Œçµæ´»ï¼Œä¸ç”¨å®ä¾‹åŒ–ä¼ é€’å‚æ•°
  // è¡¥å›ä¸¢å¤±çš„å±æ€§
  Object.defineProperty(subClass, "constructor", {
    enumerable: false,
    value: subClass,
    writable: true,
  });
}

function Canine(picture, food, hunger, boundaries) {
  // è°ƒç”¨ Animal æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”æŠŠåˆå§‹åŒ–çš„å±æ€§è®°å½•åˆ° Canine  çš„å®ä¾‹å¯¹è±¡ä¸Š
  return `Animal.call(this, picture, food, hunger, boundaries);`;
}
inheri(Canine, Animal);
```

ä» keji åˆ° Dogã€Canine ä»¥åŠ Animal æœ€ç»ˆæ„æˆçš„åŸå‹é“¾å¦‚ä¸‹å›¾ï¼š

<!-- é«˜ç¨‹3åŸå‹å›¾ä»¿ç”» -->

ä¸Šé¢å³æ˜¯æ‰€è°“çš„å¯„ç”Ÿå¼ç»„åˆå¼ç»§æ‰¿ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥è¿™æ ·

`subClass.prototype.__proto__ = superClass.prototype);`?

#### æ“ä½œç¬¦ instanceof ä¸ typeof ã€in

åœ¨å¤§éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæ£€æµ‹å¯¹è±¡æ˜¯å¦æ˜¯ç±»çš„æœ€ç›´æ¥æ–¹æ³•æ˜¯ä½¿ç”¨æ“ä½œç¬¦ instanceofã€‚ä¾‹å¦‚ï¼Œåœ¨ Java ä¸­ï¼Œä½¿ç”¨æ“ä½œç¬¦ instanceof æ£€æµ‹å·¦è¾¹çš„ç±»ä¸å³è¾¹çš„ç±»æ˜¯å¦æ˜¯åŒä¸€ä¸ªå­ç±»ã€‚

è™½ç„¶åœ¨ JavaScript ä¸­æ“ä½œç¬¦ instanceof ä¸ Java ä¸­åŸºæœ¬ç±»ä¼¼ï¼Œä½†æ˜¯ä»ç„¶æœ‰äº›ä¸åŒã€‚åœ¨ JavaScript ä¸­ï¼Œæ“ä½œç¬¦ instanceof ä½¿ç”¨åœ¨åŸå‹é“¾ä¸­ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼š

```js
```

å› ä¸º JavaScript æ˜¯ä¸€é—¨åŠ¨æ€è¯­è¨€ï¼Œåœ¨ç¨‹åºçš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹å¾ˆå¤šå†…å®¹ã€‚å› æ­¤æˆ‘ä»¬è¦å½“å¿ƒæ„é€ å‡½æ•°åŸå‹çš„æ”¹å˜ï¼Œå¯¼è‡´ instanceof çš„æ£€æµ‹é”™è¯¯ã€‚

<!-- é…å›¾ -->

<!-- å·¥å‚æ¨¡å¼-ã€‹æ„é€ å‡½æ•°æ¨¡å¼-ã€‹åŸå‹æ¨¡å¼-ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°å’ŒåŸå‹æ¨¡å¼ -->

å¦‚æœä½ ç†è§£ instanceof æ“ä½œç¬¦æ˜¯æ£€æŸ¥å³è¾¹çš„å‡½æ•°åŸå‹æ˜¯å¦å­˜åœ¨äºæ“ä½œç¬¦å·¦è¾¹çš„å¯¹è±¡çš„åŸå‹é“¾ä¸Šï¼Œå°±èƒ½ç†è§£ä¸‹é¢çš„è¾“å‡ºäº†ï¼š

```js
var a = "woot"; // undefined
var b = new String("woot"); // undefined
a + b; // 'wootwoot'
typeof a; // 'string'
typeof b; // 'object'
a instanceof String; // false
b instanceof String; // true
```

```js
typeof [] == "object";
```

åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬é€šå¸¸è¦æŸ¥çœ‹å¯¹è±¡å†…éƒ¨çš„ `[[Class]]` å€¼ï¼š`Object.prototype.toString.call([]) == '[object Array]'`ã€‚è¯¥å€¼æ˜¯ä¸å¯å˜çš„ï¼Œæœ‰åˆ©äºæˆ‘ä»¬åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ï¼ˆå¦‚æµè§ˆå™¨çª—å£ï¼‰å¯¹æ•°ç»„ç±»å‹è¿›è¡Œåˆ¤å®šï¼Œè€Œ instanceof Array è¿™ç§æ–¹å¼åªé€‚ç”¨äºä¸æ•°ç»„åˆå§‹åŒ–åœ¨ç›¸åŒä¸Šä¸‹æ–‡ä¸­æ‰æœ‰æ•ˆã€‚

åŒæ ·ï¼Œä½¿ç”¨ in æ“ä½œç¬¦å¯ä»¥æŸ¥çœ‹æŸä¸ªå±æ€§æ˜¯å¦ä½äºå®ä¾‹çš„åŸå‹é“¾ä¸Šã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¸¸å¸¸åœ¨éå†æŸä¸ªå¯¹è±¡æ—¶ï¼Œä¼šä½¿ç”¨ `Object.hasOwnProperty` æ¥æ’é™¤åŸå‹é“¾çš„å½±å“ã€‚

<!-- ä¸Šé¢çš„åˆ™æ˜¯ç»„åˆæ„é€  + åŸå‹ã€‚ -->

### ä½¿ç”¨ ES6 çš„ class å®ç°ç»§æ‰¿

ES6 å¼•å…¥æ–°çš„å…³é”®å­— classï¼Œå®ƒæä¾›äº†ä¸€ç§æ›´ä¸ºä¼˜é›…çš„åˆ›å»ºå¯¹è±¡å’Œå®ç°ç»§æ‰¿çš„æ–¹å¼ï¼Œ<u>åº•å±‚ä»ç„¶æ˜¯åŸºäºåŸå‹çš„å®ç°ã€‚</u>å…¼å®¹æ€§å¦‚ä¸‹å›¾ï¼Œé€šå¸¸å®é™…ç”Ÿäº§ç¯å¢ƒä¸­è¿˜æ˜¯è¦é€šè¿‡ babel æ’ä»¶æ¥è¿›è¡Œè½¬æ¢ã€‚

ä½¿ç”¨ ES6 æŒ‡å®šçš„å…³é”®å­— class åˆ›å»ºç±»ï¼š

```js
class Animal {
  constructor(picture, food, hunger, boundaries) {
    // å®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå½“ä½¿ç”¨å…³é”®å­— new è°ƒç”¨ç±»æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ„é€ å‡½æ•°
    this.picture = picture;
    this.food = food;
    this.hunger = hunger;
    this.boundaries = boundaries;
  }

  makeNoise() {
    // å®šä¹‰åœ¨åŸå‹ä¸Šçš„å…±æœ‰æ–¹æ³•
    // åŠ¨ç‰©å‘å‡ºå£°éŸ³çš„è¡Œä¸º
  }

  eat() {
    // åŠ¨ç‰©é‡åˆ°é£Ÿç‰©æ—¶çš„è¡Œä¸ºç¨‹åº
  }

  sleep() {
    // ç¡çœ çš„è¡Œä¸ºç¨‹åº
  }

  roam() {
    // ä¸åœ¨è¿›é£Ÿæˆ–ç¡çœ æ—¶çš„è¡Œä¸ºç¨‹åº
  }

  // å¯ä»¥é€šè¿‡ static å…³é”®å­—ï¼Œå®ç°é™æ€å‡½æ•°
  static compare(canine1, canine2) {
    return canine1.hunger - canine2;
  }
}
```

é€šè¿‡ extend å…³é”®å­—è¿›è¡Œç±»çš„ç»§æ‰¿ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­é€šè¿‡å…³é”®å­— super è°ƒç”¨è¶…ç±»çš„æ„é€ å‡½æ•°ï¼š

```js
class Canine extends Animal {
  constructor(picture, food, hunger, boundaries) {
    super(picture, food, hunger, boundaries);
  }

  makeNoise() {}

  eat() {}
}
```

å¯ä»¥çœ‹åˆ°é€šè¿‡ ES6 çš„æ–¹å¼å®šä¹‰ç±»ï¼Œæ›´åŠ ä¼˜é›…ï¼Œä¹Ÿè·Ÿä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€è¯­æ³•ä¸€è‡´ã€‚

<!-- ## æ„é€ å™¨ï¼ˆæ„é€ å‡½æ•°ï¼‰ä¸åŸå‹çš„å…³ç³»

### å±æ€§ __protoã€prototypeã€constructor åŒºåˆ«

æ„é€ å™¨ï¼ˆæ„é€ å‡½æ•°ï¼‰ï¼Œè‹±æ–‡æ˜¯ contructorï¼Œå®ƒæ˜¯å¯ä»¥æ ¹æ®åŸå‹æ„é€ å®ä¾‹å¯¹è±¡çš„æœºå™¨ï¼Œæä¾›æ¶ˆè´¹è€…ï¼ˆç”¨æˆ·ï¼‰å¯ä»¥åŸºäºè¿™ä¸ªåŸå‹ï¼ˆåœ¨ä¼ ç»Ÿé¢å‘å¯¹è±¡ä¸­å°±æ˜¯å½“å‰æ•´ä¸ªç±»ï¼‰è¿›è¡Œåˆå§‹åŒ–çŠ¶æ€æ‰€ç”¨ã€‚

ä¾‹å¦‚ `new bar()` è¿™ä¸ª `bar` æ˜¯åŸå‹ï¼Œè€Œ `bar` ç»§æ‰¿çš„ç±»ä¹Ÿæ˜¯åŸå‹ã€‚é€šå¸¸æˆ‘ä»¬ `a = new bar()` ä¹Ÿæ˜¯è°ƒç”¨ `bar` ç±»çš„æ„é€ å‡½æ•°ï¼Œç„¶ååŸºäºä»¥æ•´ä¸ªç±»ä¸ºåŸå‹è¿›è¡Œåˆ›å»ºæ–°çš„å¯¹è±¡ã€‚`bar` ä¸º `a` çš„æ„é€ å‡½æ•°ï¼Œåˆ™ `a` ä¸º `bar` çš„ä¸€ä¸ªå®ä¾‹ã€‚è€Œ bar ä½œä¸ºåŸå‹è¿˜å¯ä»¥ç»§æ‰¿å…¶ä»–çš„åŸå‹ä¾‹å¦‚ `foo`ã€‚

C#ã€Java éƒ½é€šè¿‡ class è¿›è¡ŒåŸå‹çš„å®šä¹‰ï¼ŒJS é€šè¿‡ prototype å±æ€§ï¼Œè®©æˆ‘ä»¬æ¥å…·ä½“çœ‹çœ‹ JS ä¸­åŸºäºåŸå‹çš„å®ç°è¿‡ç¨‹ã€‚ï¼ˆä¸‹å›¾æ˜¯åœ¨ è°ƒè¯•å™¨ï¼ˆdebuggerï¼‰ä¸­æŸ¥çœ‹ Person å‡½æ•°çš„å±æ€§ï¼‰

![](../.vuepress/public/images/2020-08-05-14-20-18-prototype.png)

ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºå‡½æ•° Person çš„ `prototype` å±æ€§åŒ…å«äº†ä¸¤ä¸ªå±æ€§ï¼Œä¸€ä¸ªæ˜¯ construtor æ„é€ å™¨æŒ‡å‘æ„é€ å‡½æ•°ï¼Œè·Ÿä¼ ç»Ÿé¢å‘å¯¹è±¡çš„æ„é€ å‡½æ•°æ˜¯ä¸€æ ·çš„é“ç†ã€‚ä¸€ä¸ªæ˜¯ `__proto__` æŒ‡å‘å®ƒçš„ä¸Šä¸€å±‚åŸå‹ Object å‡½æ•°ã€‚

è¿™ä¸ª prototype å…¶å®å°±å¯ä»¥ç±»æ¯” Java çš„ classï¼Œclass å¸¦æœ‰ æ„é€ å‡½æ•°ï¼Œç”¨æ¥æ„é€ åŸå‹çš„å®ä¾‹ã€‚è€Œ `__proto__` åˆ™ç›¸å½“äºJava çš„ extend æ“ä½œç¬¦ã€‚ -->

<!-- ### **proto** ä¸ prototype çš„åŒºåˆ«

### constructor ä¸ prototype çš„åŒºåˆ« -->

## åº”ç”¨åœºæ™¯

å‰é¢ä¸€ç›´åœ¨è®¨è®ºåŸå‹ä¸ç»§æ‰¿ï¼Œé‚£åœ¨å®é™…å¼€å‘ä¸­åŸå‹å¯ä»¥è®©æˆ‘ä»¬åšä»€ä¹ˆã€‚

### ç»™ JS API æ‰©å±•å±æ€§

å¾ˆå¤šæ—¶å€™ï¼Œç‰¹åˆ«æ˜¯åœ¨è½¯ä»¶ä¸­ï¼Œæƒ³è¦ç”¨è‡ªç„¶è¯­è¨€æ¥æè¿°æ—¥æœŸè·ç¦»æŸä¸ªç‰¹å®šæ—¶é—´ç‚¹çš„æ—¶é—´é—´éš”ã€‚æ¯”å¦‚ï¼Œâ€œæŸä»¶äº‹æƒ…å‘ç”Ÿåœ¨ 3 ç§’é’Ÿå‰â€ è¿™ç§è¡¨è¾¾ï¼Œè¿œè¦æ¯”â€œæŸä»¶äº‹æƒ…å‘ç”Ÿåœ¨ x å¹´ x æœˆ x æ—¥â€ è¿™ç§è¡¨è¾¾æ›´å®¹æ˜“ç†è§£ã€‚å¸¸è§çš„åœºæ™¯ä¾‹å¦‚å¾®ä¿¡æœ‹å‹åœˆçš„å‘å¸ƒæ—¶é—´ã€åšå®¢å‘å¸–ç­‰ã€‚

ä¸‹é¢çš„ä¾‹å­ï¼Œä¸ºæ‰€æœ‰çš„ Date å®ä¾‹éƒ½æ·»åŠ äº† ago è·å–å™¨ï¼Œå®ƒä¼šè¿”å›è‡ªç„¶è¯­è¨€æè¿°çš„æ—¥æœŸè·ç¦»ç°åœ¨ çš„æ—¶é—´é—´éš”ã€‚ç®€å•åœ°è®¿é—®è¯¥å±æ€§å°±ä¼šè°ƒç”¨äº‹å…ˆå®šä¹‰å¥½çš„å‡½æ•°ï¼Œæ— é¡»æ˜¾å¼è°ƒç”¨ã€‚

```js
Object.defineProperty(Date.prototype, "ago", {
  get: function() {
    const diff = (new Date().getTime() - this.getTime()) / 1000; // get seconds
    let dayDiff = Math.floor(diff / 86400); // get days
    return (
      (dayDiff === 0 && diff < 60 && "just now") ||
      (diff < 120 && "1 minute ago") ||
      (diff < 3600 && Math.floor(diff / 60) + "minutes ago") ||
      (diff < 7200 && "1 hour ago") ||
      (diff < 86400 && Math.floor(diff / 3600) + "hours ago") ||
      (dayDiff == 1 && "Yesterday") ||
      (dayDiff < 7 && dayDiff + "days ago") ||
      Math.ceil(dayDiff / 7) + "weeks ago"
    );
  },
});

const a = new Date("2018-11-22T09:30:00");
console.log(a.ago); // 91 weeks ago
```

### ç»™ç¬¬ä¸‰æ–¹åº“ã€æ¡†æ¶å¢åŠ å±æ€§

æ‹¿ Vue é¡¹ç›®ä¸¾ä¾‹ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¦‚æœè¦å†™ä¸€ä¸ª Vue æ¶ˆæ¯å¼¹çª—[æ’ä»¶](https://cn.vuejs.org/v2/guide/plugins.html)ï¼Œé€šè¿‡ä¸‹é¢ä»£ç è¿™æ ·ä½¿ç”¨ï¼š

```js
this.$Message(options);
```

é€šè¿‡æŸ¥çœ‹ Vue æ‰“åŒ…åçš„æºç ï¼Œå¯ä»¥å‘ç°å®ä¾‹å…¬å…±çš„æ–¹æ³•ã€å±æ€§éƒ½æ”¾åˆ° `prototype` å¯¹è±¡ä¸Šäº†ã€‚è€Œ Vue æ¡†æ¶æä¾›äº† `install` å®ç°è§„èŒƒï¼Œè®©æ·»åŠ  Vue å®ä¾‹æ–¹æ³•ï¼Œé€šè¿‡æŠŠå®ƒä»¬æ·»åŠ åˆ° `Vue.prototype` ä¸Šå®ç°ã€‚

Message ç»„ä»¶

```html
<template>
  <transition>
    <div class="parent" v-if="show">
      <div class="child">{{ message }}</div>
    </div>
  </transition>
</template>
<script>
  export default {
    name: "toast",
    data() {
      return {
        message: "message",
        show: false,
      };
    },
  };
</script>
```

æ’ä»¶å¯¹è±¡

```js
import toastComponent from "./toast.vue";

const Toast = {};

let $vm; // å­˜å‚¨ Vue å®ä¾‹

Toast.install = function(Vue, options) {
  // ä¸é‡å¤
  if (Toast.installed) return;
  Toast.installed = true;
  // æŒ‚è½½ $toast åˆ° Vue çš„åŸå‹é“¾ä¸­
  // åç»­åªéœ€è¦é€šè¿‡ this.$toast å³å¯ä½¿ç”¨
  // ä¼ é€’äº†å››ä¸ªå‚æ•°
  // message å±•ç¤ºçš„å†…å®¹
  // duration æ—¶é•¿
  // callback å…³é—­æ—¶çš„å›è°ƒå‡½æ•°
  // config æš‚æ—¶æ— ç”¨
  console.log(options);
  function createToast(message, duration, callback, config) {
    console.log(config);
    // ä½¿ç”¨ Vue.extend åˆ›å»ºä¸€ä¸ªå­ç±»
    let Ext = Vue.extend(toastComponent);
    if (!$vm) {
      $vm = new Ext({
        el: document.createElement("div"),
      });
    }

    // ç»™å¯¹è±¡èµ‹å€¼
    $vm.message = message || "message";
    $vm.duration = duration || 2500;
    $vm.show = true;

    // æŒ‚è½½åˆ° dom ä¸­
    document.body.appendChild($vm.$el);

    // å»¶æ—¶æ¶ˆå¤±
    setTimeout(() => {
      $vm.show = false;
      typeof callback === "function" && callback();
    }, $vm.duration);
  }
  Vue.prototype.$toast = createToast;
};

export default Toast;
```

ä¸Šé¢ [Vue.extend](https://cn.vuejs.org/v2/api/#Vue-extend) APIï¼Œç”¨äºå‘½ä»¤å¼çš„åˆ›å»ºç»„ä»¶ï¼Œè€Œä¸æ˜¯å£°æ˜å¼ï¼Œæœ€åæ‰‹åŠ¨ append åˆ° dom ä¸­ã€‚åœ¨ iview ç»„ä»¶åº“çš„ message ç»„ä»¶ï¼Œæ˜¯ç”¨è¿™ä¸ª api å»åŠ¨æ€æ„é€ ç»„ä»¶çš„

ç¬¬ä¸‰æ–¹ä½¿ç”¨ï¼š

```html
<template>
  <div><h2>Hello, MyPlugin</h2></div>
</template>

<script>
  export default {
    mounted() {
      console.log(this.$toast("Hello, Jecyu!"));
    },
  };
</script>
```

## å°ç»“

ECMASCript æ”¯æŒé¢å‘å¯¹è±¡ï¼ˆOOï¼‰ç¼–ç¨‹ã€‚ä½†ä¸ä½¿ç”¨ç±»æˆ–è€…æ¥å£ã€‚å¯¹è±¡å¯ä»¥åœ¨ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­åˆ›å»ºå’Œå¢å¼ºï¼Œå› æ­¤å…·æœ‰åŠ¨æ€æ€§è€Œéä¸¥æ ¼å®šä¹‰çš„å®ä½“ã€‚åœ¨æ²¡æœ‰ç±»çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨æ„é€ å‡½æ•°å®šä¹‰å®ä¾‹å±æ€§ï¼Œè€Œä½¿ç”¨åŸå‹å®šä¹‰å…±äº«çš„å±æ€§å’Œæ–¹æ³•ã€‚

JavaScript ä¸»è¦é€šè¿‡åŸå‹é“¾å®ç°ç»§æ‰¿ã€‚åŸå‹é“¾çš„æ„å»ºæ˜¯é€šè¿‡å°†ä¸€ä¸ªå®ä¾‹èµ‹ç»™å¦ä¸€ä¸ªæ„é€ å‡½æ•°çš„åŸå‹å®ç°çš„ã€‚å¹¶ä¸”åœ¨å­ç±»æ„é€ å‡½æ•°çš„å†…éƒ¨è°ƒç”¨è¶…ç±»å‹æ„é€ å‡½æ•°ï¼Œè¿™æ ·å°±å¯ä»¥åšåˆ°æ¯ä¸ªå®ä¾‹éƒ½å…·æœ‰è‡ªå·±çš„å±æ€§ï¼ŒåŒæ—¶è¿˜èƒ½ä¿è¯åªä½¿ç”¨æ„é€ å‡½æ•°æ¥å®šä¹‰ç±»å‹ã€‚

è¿›ä¸€æ­¥ï¼Œå¯ä»¥å­¦ä¹ é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ IoCï¼ˆæ§åˆ¶åè½¬ï¼‰å’Œ DIï¼ˆä¾èµ–æ³¨å…¥ï¼‰ çš„è®¾è®¡æ€æƒ³ã€‚å‚è€ƒ[äº†ä¸èµ·çš„ IoC ä¸ DI](https://mp.weixin.qq.com/s/0EBP8_vsnh92Uv17bdRQcA)

é¢å‘å¯¹è±¡ç»§æ‰¿çš„ç¼ºç‚¹ã€‚<!-- æ„é€ å™¨ã€‚é¢å‘è¿‡ç¨‹ã€é¢å‘å¯¹è±¡ï¼Œç¨å¾®æä¸‹å‡½æ•°å¼ç¼–ç¨‹ï¼Œåƒé¢å‘è¿‡ç¨‹çš„ C è¯­è¨€æ˜¯å¦‚ä½•æé«˜å†™æ³•çš„å‘¢  ts ç¿»è¯‘çš„æ–‡ç« -->

å¦‚ä½•åˆ›å»ºä¸€ä¸ªæ²¡æœ‰åŸå‹çš„å¯¹è±¡ `Object.create(null)`
[javascript:åˆ©ç”¨ Object.create()æ–¹æ³•åˆ›å»ºå¯¹è±¡](https://blog.csdn.net/hutaoer06051/article/details/7983316)ï¼Œæ²¡æœ‰ Object å†…ç½®çš„ toString()ã€valueOf ç­‰æ–¹æ³•ã€‚

å¦å¤–ï¼Œåƒ UML å»ºæ¨¡ï¼Œé¡¾åæ€ä¹‰å»ºç«‹æ¨¡å‹ï¼Œä¹Ÿæ˜¯å»ºç«‹åŸå‹çš„è¿‡ç¨‹ï¼Œä¹‹åå†å¯¹ç³»ç»Ÿè¿›è¡Œå…·ä½“çš„ç¼–ç ã€‚é¢å‘å¯¹è±¡ä¸è®¾è®¡åˆ†æã€‚

## å‚è€ƒèµ„æ–™

- é¢å‘å¯¹è±¡ç»§æ‰¿çš„ç¼ºç‚¹ï¼›
- [vue-plugin-event-bus](https://github.com/shooterRao/vue-plugin-event-bus/blob/master/src/index.ts)
- [å¦‚ä½•å†™ä¸€ä¸ª Vue çš„æ’ä»¶](https://juejin.im/post/6844903586845966350)
- [Details of the object model](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Details_of_the_Object_Model) å€¼å¾—ç²¾è¯»çš„ MDN æ–‡æ¡£ï¼Œå…³äºåŸºäºç±»ç»§æ‰¿ä¸åŸºäºåŸå‹ç»§æ‰¿çš„åŒºåˆ«è¯´å¾—æŒºæ¸…æ¥šçš„ã€‚
- [Object.prototype.constructor](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor)
- [æ·±å…¥æ¢ç©¶ Function & Object é¸¡è›‹é—®é¢˜](https://github.com/yygmind/blog/issues/35)
- [ã€è¿›é˜¶ 5-2 æœŸã€‘å›¾è§£åŸå‹é“¾åŠå…¶ç»§æ‰¿ä¼˜ç¼ºç‚¹](https://github.com/yygmind/blog/issues/35)
- [ã€è¿›é˜¶ 5-1 æœŸã€‘é‡æ–°è®¤è¯†æ„é€ å‡½æ•°ã€åŸå‹å’ŒåŸå‹é“¾](https://juejin.im/post/5c6a9c10f265da2db87b98f3)
- [wiki åŸå‹](https://zh.wikipedia.org/wiki/%E5%8E%9F%E5%9E%8B)
- [Prototype](https://en.wikipedia.org/wiki/Prototype#cite_note-:0-1)
- [æ‰€è°“åŸå‹ï¼Œæ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿ](http://www.woshipm.com/pd/144880.html)
- [å»–é›ªå³° JavaScript æ•™ç¨‹](https://www.liaoxuefeng.com/wiki/1022910821149312/1023021997355072)
- [å†è°ˆ JavaScript é¢å‘å¯¹è±¡æ€æƒ³åŠç»§æ‰¿](https://segmentfault.com/a/1190000011770117)
- [JS å’Œå…¶ä»–é¢å‘å¯¹è±¡è¯­è¨€çš„åŒºåˆ«](https://www.jianshu.com/p/387677d13f99?utm_campaign=maleskine&utm_content=note&utm_medium=seo_notes&utm_source=recommendation)
- [Trying to understand the difference between prototype and constructor in JavaScript](https://stackoverflow.com/questions/28600238/trying-to-understand-the-difference-between-prototype-and-constructor-in-javascr)
- [java ç»§æ‰¿](https://www.liaoxuefeng.com/wiki/1252599548343744/1260454548196032)
- [ç®€å•ç²—æš´åœ°ç†è§£ js åŸå‹é“¾â€“js é¢å‘å¯¹è±¡ç¼–ç¨‹](https://mp.weixin.qq.com/s/93CQRYj8TraDIKeJxNGPAQ)
- [Babel â€”â€” ç¼–è¯‘ JS å·¥å…·](https://babeljs.io/) å¯ä»¥åœ¨çº¿ç¼–è¯‘
- [èŠèŠ new æ“ä½œç¬¦ä»¥åŠå’Œ Object.create çš„åŒºåˆ«](https://juejin.im/post/6844904034730524686#heading-2)
- ã€ŠHead First Javaã€‹
- ã€ŠJavaScript å¿è€…ç§˜ç±ã€‹
- ã€ŠJavaScript é«˜çº§ç¨‹åºè®¾è®¡ 3ã€‹
