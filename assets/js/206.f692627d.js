(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{1452:function(a,n,t){"use strict";t.r(n);var s=t(44),r=Object(s.a)({},(function(){var a=this,n=a.$createElement,t=a._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"npm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#npm"}},[a._v("#")]),a._v(" npm")]),a._v(" "),t("h2",{attrs:{id:"初始化一个项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始化一个项目"}},[a._v("#")]),a._v(" 初始化一个项目")]),a._v(" "),t("p",[a._v("在项目里没有安装任何 "),t("code",[a._v("npm")]),a._v(" 时，先使用以下命令生成 package.json 描述文件，否则直接安装 "),t("code",[a._v("npm")]),a._v(" 依赖包的话，会被安装到全局环境下。")]),a._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v(" init 或 "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" init\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("如果没有安装 yarn，推荐全局安装")]),a._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v(" -g\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("help")]),a._v(" COMMAND\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h2",{attrs:{id:"npm-和-yarn-的区别，我们该如何选择？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#npm-和-yarn-的区别，我们该如何选择？"}},[a._v("#")]),a._v(" npm 和 yarn 的区别，我们该如何选择？")]),a._v(" "),t("p",[a._v("Yarn 是什么？\n“Yarn 是由 Facebook、Google、Exponent 和 Tilde 联合推出了一个新的 JS 包管理工具 ，正如官方文档中写的，Yarn 是为了弥补 npm 的一些缺陷而出现的。”这句话让我想起了使用 npm 时的坑了：")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("npm install 的时候巨慢。特别是新的项目拉下来要等半天，删除 "),t("code",[a._v("node_modules")]),a._v("，重新 "),t("code",[a._v("install")]),a._v(" 的时候依旧如此。")])]),a._v(" "),t("li",[t("p",[a._v("同一个项目，安装的时候无法保持一致性。由于 "),t("code",[a._v("package.json")]),a._v(" 文件中版本号的特点，下面三个版本号在安装的时候代表不同的含义。")])]),a._v(" "),t("li",[t("p",[a._v('"5.0.3",')])]),a._v(" "),t("li",[t("p",[a._v('"~5.0.3",')])]),a._v(" "),t("li",[t("p",[a._v('"^5.0.3"')])])]),a._v(" "),t("p",[t("u",[a._v("“5.0.3”表示安装指定的 "),t("code",[a._v("5.0.3")]),a._v(" 版本，“～ 5.0.3” 表示安装 "),t("code",[a._v("5.0.X")]),a._v(" 中最新的版本，“^5.0.3” 表示安装 "),t("code",[a._v("5.X.X")]),a._v(" 中最新的版本。这就麻烦了，常常会出现同一个项目，有的同事是 OK 的，有的同事会由于安装的版本不一致出现 bug。")])]),a._v(" "),t("ul",[t("li",[a._v("安装的时候，包会在同一时间下载和安装，中途某个时候，一个包抛出了一个错误，但是 npm 会继续下载和安装包。因为 npm 会把所有的日志输出到终端，有关错误包的错误信息就会在一大堆 npm 打印的警告中丢失掉，并且你甚至永远不会注意到实际发生的错误。")])]),a._v(" "),t("p",[a._v("带着这些坑，我开始了解 Yarn 的优势及其解决的问题。")]),a._v(" "),t("h3",{attrs:{id:"yarn-的优点？"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yarn-的优点？"}},[a._v("#")]),a._v(" Yarn 的优点？")]),a._v(" "),t("ul",[t("li",[t("strong",[a._v("速度快")]),a._v("。速度快主要来自以下两个方面：\n"),t("ul",[t("li",[a._v("并行安装：无论 npm 还是 Yarn 在执行包的安装时，都会执行一系列任务。《npm 是按照队列执行每个 package，也就是说必须要等到当前 package 安装完成之后，才能继续后面的安装。而 Yarn 是同步执行所有任务，提高了性能。")]),a._v(" "),t("li",[a._v("离线模式：如果之前已经安装过一个软件包，用 Yarn 再次安装时之间从缓存中获取，就不用像 npm 那样再从网络下载了。")])])]),a._v(" "),t("li",[t("strong",[a._v("安装版本统一")]),a._v("：为了防止拉取到不同的版本，Yarn 有一个锁定文件 (lock file) 记录了被确切安装上的模块的版本号。每次只要新增了一个模块，Yarn 就会创建（或更新）"),t("code",[a._v("yarn.lock")]),a._v(" 这个文件。这么做就保证了，每一次拉取同一个项目依赖时，使用的都是一样的模块版本。npm 其实也有办法实现处处使用相同版本的 packages，但需要开发者执行 "),t("code",[a._v("npm shrinkwrap")]),a._v(" 命令。这个命令将会生成一个锁定文件，在执行 npm install 的时候，该锁定文件会先被读取，和 Yarn 读取 "),t("code",[a._v("yarn.lock")]),a._v(" 文件一个道理。npm 和 Yarn 两者的不同之处在于，Yarn 默认会生成这样的锁定文件，而 npm 要通过 "),t("code",[a._v("shrinkwrap")]),a._v(" 命令生成 "),t("code",[a._v("npm-shrinkwrap.json")]),a._v(" 文件，只有当这个文件存在的时候，packages 版本信息才会被记录和更新。")]),a._v(" "),t("li",[t("strong",[a._v("更简洁的输出")]),a._v("：npm 的输出信息比较冗长。在执行 npm install 的时候，命令行里会不断地打印出所有被安装上的依赖。相比之下，Yarn 简洁太多：默认情况下，结合了 emoji 直观且直接地打印出必要的信息，也提供了一些命令供开发者查询额外的安装信息。\n多注册来源处理：所有的依赖包，不管他被不同的库间接关联引用多少次，安装这个包时，只会从一个注册来源去装，要么是 npm 要么是 bower, 防止出现混乱不一致。")]),a._v(" "),t("li",[t("strong",[a._v("更好的语义化")]),a._v("： yarn 改变了一些 npm 命令的名称，比如 "),t("code",[a._v("yarn add/remove")]),a._v("，感觉上比 npm 原本的 "),t("code",[a._v("install/uninstall")]),a._v(" 要更清晰。")])]),a._v(" "),t("h3",{attrs:{id:"yarn-的安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yarn-的安装"}},[a._v("#")]),a._v(" yarn 的安装:")]),a._v(" "),t("p",[a._v("下载 node.js，使用 npm 安装\nnpm install -g yarn\n查看版本：yarn --version\n安装 node.js,下载 yarn 的安装程序:\n提供一个.msi 文件，在运行时将引导您在 Windows 上安装 Yarn\nYarn 淘宝源安装，分别复制粘贴以下代码行到黑窗口运行即可\nyarn config set registry https://registry.npm.taobao.org -g\nyarn config set sass_binary_site http://cdn.npm.taobao.org/dist/node-sass -g")]),a._v(" "),t("h2",{attrs:{id:"npm-vs-yarn-命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#npm-vs-yarn-命令"}},[a._v("#")]),a._v(" npm vs yarn 命令")]),a._v(" "),t("blockquote",[t("p",[a._v("yarn https://yarnpkg.com/en/docs/migrating-from-npm")])]),a._v(" "),t("table",[t("thead",[t("tr",[t("td",[a._v(" npm(v5) ")]),a._v(" "),t("td",[a._v(" Yarn ")])])]),a._v(" "),t("tbody",[t("tr",[t("td",[a._v("npm install")]),a._v(" "),t("td",[a._v("yarn install")])]),a._v(" "),t("tr",[t("td",[a._v("npm install --no-package-lock")]),a._v(" "),t("td",[a._v("yarn install --no-lockfile")])]),a._v(" "),t("tr",[t("td",[a._v("npm install [package] --save")]),a._v(" "),t("td",[a._v("yarn add [package]")])]),a._v(" "),t("tr",[t("td",[a._v("npm install [package] --save-dev")]),a._v(" "),t("td",[a._v("yarn add [package] --dev")])]),a._v(" "),t("tr",[t("td",[a._v("npm install [package] --global")]),a._v(" "),t("td",[a._v("yarn global add [package]")])]),a._v(" "),t("tr",[t("td",[a._v("npm uninstall [package] --global")]),a._v(" "),t("td",[a._v("yarn global remove [package]")])]),a._v(" "),t("tr",[t("td",[a._v("npm uninstall [package]")]),a._v(" "),t("td",[a._v("yarn remove [package]")])]),a._v(" "),t("tr",[t("td",[a._v("npm cache clean")]),a._v(" "),t("td",[a._v("yarn cache clean [package]")])]),a._v(" "),t("tr",[t("td",[a._v("rm -rf node_modules && npm install")]),a._v(" "),t("td",[a._v("yarn upgrade")])]),a._v(" "),t("tr",[t("td",[a._v("npm update --global")]),a._v(" "),t("td",[a._v("yarn global update")])])])]),a._v(" "),t("p",[a._v("升级依赖包，直接 "),t("code",[a._v("yarn add xxx")]),a._v(" 即可覆盖。")]),a._v(" "),t("h2",{attrs:{id:"npm-换源"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#npm-换源"}},[a._v("#")]),a._v(" npm 换源")]),a._v(" "),t("p",[a._v("一、使用淘宝镜像")]),a._v(" "),t("ol",[t("li",[a._v("临时使用")])]),a._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" --registry https://registry.npm.taobao.org "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" express\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("持久使用")])]),a._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" config "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" registry https://registry.npm.taobao.org\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[a._v("通过 cnpm")])]),a._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" -g cnpm --registry"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("https://registry.npm.taobao.org\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("二、使用官方镜像")]),a._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" config "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" registry https://registry.npmjs.org/\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("三、查看 npm 源地址")]),a._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" config get registry\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h2",{attrs:{id:"关于-npm-包版本号前缀-和-区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#关于-npm-包版本号前缀-和-区别"}},[a._v("#")]),a._v(" 关于 npm 包版本号前缀 "),t("code",[a._v("~")]),a._v(" 和 "),t("code",[a._v("^")]),a._v(" 区别")]),a._v(" "),t("ul",[t("li",[t("p",[t("code",[a._v("~")]),a._v(" 会匹配安装最近的小版本依赖包，比如"),t("code",[a._v("~1.2.3")]),a._v("会匹配所有 1.2.x 版本，但是不包括 1.3.0")])]),a._v(" "),t("li",[t("p",[t("code",[a._v("^")]),a._v(" 会匹配安装最新的大版本依赖包，比如"),t("code",[a._v("^1.2.3")]),a._v("会匹配所有 1.x.x 的包，包括 1.3.0，但是不包括 2.0.0")])])]),a._v(" "),t("h2",{attrs:{id:"全局安装和本地安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#全局安装和本地安装"}},[a._v("#")]),a._v(" 全局安装和本地安装")]),a._v(" "),t("h2",{attrs:{id:"开发依赖和生产依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开发依赖和生产依赖"}},[a._v("#")]),a._v(" 开发依赖和生产依赖")]),a._v(" "),t("h2",{attrs:{id:"yarn-add"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#yarn-add"}},[a._v("#")]),a._v(" yarn add")]),a._v(" "),t("p",[a._v("大多数的包会从 "),t("code",[a._v("npm registry")]),a._v(" 目录里以包名来安装。")]),a._v(" "),t("ol",[t("li",[t("code",[a._v("yarn add package-name")]),a._v(" 会安装 latest 最新版本。")]),a._v(" "),t("li",[t("code",[a._v("yarn add package-name@1.2.3")]),a._v(" 会从 registry 里安装这个包的指定版本。")]),a._v(" "),t("li",[t("code",[a._v("yarn add package-name@tag")]),a._v(" 会安装某个 “tag” 标识的版本（比如 beta、next 或者 latest）。")])]),a._v(" "),t("p",[a._v("指定不同路径的包：")]),a._v(" "),t("ol",[t("li",[t("code",[a._v("yarn add file:/path/to/local/folder")]),a._v(" 从本地系统里安装一个包，可以用这种方式测试还没发布的包。")]),a._v(" "),t("li",[t("code",[a._v("yarn add file:/path/to/local/tarball.tgz")]),a._v(" 安装一个 gzipped 压缩包，此格式可以用于在发布之前分享你的包。")]),a._v(" "),t("li",[t("code",[a._v("yarn add <git remote url>")]),a._v(" 从远程 git repo 里安装一个包。")]),a._v(" "),t("li",[t("code",[a._v("yarn add <git remote url>#<branch/commit/tag>")]),a._v(" 从一个远程 git 仓库指定的 git 分支、git 提交记录或 git 标签安装一个包。")]),a._v(" "),t("li",[a._v("yarn add https://my-project.org/package.tgz 用一个远程 gzipped 压缩包来安装。")])]),a._v(" "),t("h2",{attrs:{id:"参考资料"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[a._v("#")]),a._v(" 参考资料")]),a._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/27449990",target:"_blank",rel:"noopener noreferrer"}},[a._v("npm 和 yarn 的区别，我们该如何选择？"),t("OutboundLink")],1)]),a._v(" "),t("li",[t("a",{attrs:{href:"https://www.sitepoint.com/yarn-vs-npm/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Yarn vs npm: Everything You Need to Know"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);n.default=r.exports}}]);